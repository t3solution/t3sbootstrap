(function(e){"use strict";var f="data-highlighted",s="data-timestamp",p={ELEMENT_NODE:1,TEXT_NODE:3},h=["SCRIPT","STYLE","SELECT","OPTION","BUTTON","OBJECT","APPLET","VIDEO","AUDIO","CANVAS","EMBED","PARAM","METER","PROGRESS"];function haveSameColor(e,t){return g(e).color()===g(t).color()}function defaults(e,t){e=e||{};for(var i in t){if(t.hasOwnProperty(i)&&e[i]===void 0){e[i]=t[i]}}return e}function unique(e){return e.filter(function(e,t,i){return i.indexOf(e)===t})}function refineRangeBoundaries(e){var t=e.startContainer,i=e.endContainer,n=e.commonAncestorContainer,r=true;if(e.endOffset===0){while(!i.previousSibling&&i.parentNode!==n){i=i.parentNode}i=i.previousSibling}else if(i.nodeType===p.TEXT_NODE){if(e.endOffset<i.nodeValue.length){i.splitText(e.endOffset)}}else if(e.endOffset>0){i=i.childNodes.item(e.endOffset-1)}if(t.nodeType===p.TEXT_NODE){if(e.startOffset===t.nodeValue.length){r=false}else if(e.startOffset>0){t=t.splitText(e.startOffset);if(i===t.previousSibling){i=t}}}else if(e.startOffset<t.childNodes.length){t=t.childNodes.item(e.startOffset)}else{t=t.nextSibling}return{startContainer:t,endContainer:i,goDeeper:r}}function sortByDepth(e,i){e.sort(function(e,t){return g(i?t:e).parents().length-g(i?e:t).parents().length})}function groupHighlights(e){var i=[],n={},r=[];e.forEach(function(e){var t=e.getAttribute(s);if(typeof n[t]==="undefined"){n[t]=[];i.push(t)}n[t].push(e)});i.forEach(function(e){var t=n[e];r.push({chunks:t,timestamp:e,toString:function(){return t.map(function(e){return e.textContent}).join("")}})});return r}var g=function(r){return{addClass:function(e){if(r.classList){r.classList.add(e)}else{r.className+=" "+e}},removeClass:function(e){if(r.classList){r.classList.remove(e)}else{r.className=r.className.replace(new RegExp("(^|\\b)"+e+"(\\b|$)","gi")," ")}},prepend:function(e){var t=Array.prototype.slice.call(e),i=t.length;while(i--){r.insertBefore(t[i],r.firstChild)}},append:function(e){var t=Array.prototype.slice.call(e);for(var i=0,n=t.length;i<n;++i){r.appendChild(t[i])}},insertAfter:function(e){return e.parentNode.insertBefore(r,e.nextSibling)},insertBefore:function(e){return e.parentNode.insertBefore(r,e)},remove:function(){r.parentNode.removeChild(r);r=null},contains:function(e){return r!==e&&r.contains(e)},wrap:function(e){if(r.parentNode){r.parentNode.insertBefore(e,r)}e.appendChild(r);return e},unwrap:function(){var e=Array.prototype.slice.call(r.childNodes),t;e.forEach(function(e){t=e.parentNode;g(e).insertBefore(e.parentNode);g(t).remove()});return e},parents:function(){var e,t=[];while(!!(e=r.parentNode)){t.push(e);r=e}return t},normalizeTextNodes:function(){if(!r){return}if(r.nodeType===p.TEXT_NODE){while(r.nextSibling&&r.nextSibling.nodeType===p.TEXT_NODE){r.nodeValue+=r.nextSibling.nodeValue;r.parentNode.removeChild(r.nextSibling)}}else{g(r.firstChild).normalizeTextNodes()}g(r.nextSibling).normalizeTextNodes()},color:function(){return r.style.backgroundColor},fromHTML:function(e){var t=document.createElement("div");t.innerHTML=e;return t.childNodes},getRange:function(){var e=g(r).getSelection(),t;if(e.rangeCount>0){t=e.getRangeAt(0)}return t},removeAllRanges:function(){var e=g(r).getSelection();e.removeAllRanges()},getSelection:function(){return g(r).getWindow().getSelection()},getWindow:function(){return g(r).getDocument().defaultView},getDocument:function(){return r.ownerDocument||r}}};function bindEvents(e,t){e.addEventListener("mouseup",t.highlightHandler.bind(t));e.addEventListener("touchend",t.highlightHandler.bind(t))}function unbindEvents(e,t){e.removeEventListener("mouseup",t.highlightHandler.bind(t));e.removeEventListener("touchend",t.highlightHandler.bind(t))}function TextHighlighter(e,t){if(!e){throw"Missing anchor element"}this.el=e;this.options=defaults(t,{color:"#ffff7b",highlightedClass:"highlighted",contextClass:"highlighter-context",onRemoveHighlight:function(){return true},onBeforeHighlight:function(){return true},onAfterHighlight:function(){}});g(this.el).addClass(this.options.contextClass);bindEvents(this.el,this)}TextHighlighter.prototype.destroy=function(){unbindEvents(this.el,this);g(this.el).removeClass(this.options.contextClass)};TextHighlighter.prototype.highlightHandler=function(){this.doHighlight()};TextHighlighter.prototype.doHighlight=function(e){var t=g(this.el).getRange(),i,n,r,o;if(!t||t.collapsed){return}if(this.options.onBeforeHighlight(t)===true){o=+new Date;i=TextHighlighter.createWrapper(this.options);i.setAttribute(s,o);n=this.highlightRange(t,i);r=this.normalizeHighlights(n);this.options.onAfterHighlight(t,r,o)}if(!e){g(this.el).removeAllRanges()}};TextHighlighter.prototype.highlightRange=function(e,t){if(!e||e.collapsed){return[]}var i=refineRangeBoundaries(e),n=i.startContainer,r=i.endContainer,o=i.goDeeper,s=false,a=n,l=[],c,d,u;do{if(o&&a.nodeType===p.TEXT_NODE){if(h.indexOf(a.parentNode.tagName)===-1&&a.nodeValue.trim()!==""){d=t.cloneNode(true);d.setAttribute(f,true);u=a.parentNode;if(g(this.el).contains(u)||u===this.el){c=g(a).wrap(d);l.push(c)}}o=false}if(a===r&&!(r.hasChildNodes()&&o)){s=true}if(a.tagName&&h.indexOf(a.tagName)>-1){if(r.parentNode===a){s=true}o=false}if(o&&a.hasChildNodes()){a=a.firstChild}else if(a.nextSibling){a=a.nextSibling;o=true}else{a=a.parentNode;o=false}}while(!s);return l};TextHighlighter.prototype.normalizeHighlights=function(e){var t;this.flattenNestedHighlights(e);this.mergeSiblingHighlights(e);t=e.filter(function(e){return e.parentElement?e:null});t=unique(t);t.sort(function(e,t){return e.offsetTop-t.offsetTop||e.offsetLeft-t.offsetLeft});return t};TextHighlighter.prototype.flattenNestedHighlights=function(s){var e,a=this;sortByDepth(s,true);function flattenOnce(){var o=false;s.forEach(function(e,t){var i=e.parentElement,n=i.previousSibling,r=i.nextSibling;if(a.isHighlight(i)){if(!haveSameColor(i,e)){if(!e.nextSibling){g(e).insertBefore(r||i);o=true}if(!e.previousSibling){g(e).insertAfter(n||i);o=true}if(!i.hasChildNodes()){g(i).remove()}}else{i.replaceChild(e.firstChild,e);s[t]=i;o=true}}});return o}do{e=flattenOnce()}while(e)};TextHighlighter.prototype.mergeSiblingHighlights=function(e){var i=this;function shouldMerge(e,t){return t&&t.nodeType===p.ELEMENT_NODE&&haveSameColor(e,t)&&i.isHighlight(t)}e.forEach(function(e){var t=e.previousSibling,i=e.nextSibling;if(shouldMerge(e,t)){g(e).prepend(t.childNodes);g(t).remove()}if(shouldMerge(e,i)){g(e).append(i.childNodes);g(i).remove()}g(e).normalizeTextNodes()})};TextHighlighter.prototype.setColor=function(e){this.options.color=e};TextHighlighter.prototype.getColor=function(){return this.options.color};TextHighlighter.prototype.removeHighlights=function(e){var t=e||this.el,i=this.getHighlights({container:t}),n=this;function mergeSiblingTextNodes(e){var t=e.previousSibling,i=e.nextSibling;if(t&&t.nodeType===p.TEXT_NODE){e.nodeValue=t.nodeValue+e.nodeValue;g(t).remove()}if(i&&i.nodeType===p.TEXT_NODE){e.nodeValue=e.nodeValue+i.nodeValue;g(i).remove()}}function removeHighlight(e){var t=g(e).unwrap();t.forEach(function(e){mergeSiblingTextNodes(e)})}sortByDepth(i,true);i.forEach(function(e){if(n.options.onRemoveHighlight(e)===true){removeHighlight(e)}})};TextHighlighter.prototype.getHighlights=function(e){e=defaults(e,{container:this.el,andSelf:true,grouped:false});var t=e.container.querySelectorAll("["+f+"]"),i=Array.prototype.slice.call(t);if(e.andSelf===true&&e.container.hasAttribute(f)){i.push(e.container)}if(e.grouped){i=groupHighlights(i)}return i};TextHighlighter.prototype.isHighlight=function(e){return e&&e.nodeType===p.ELEMENT_NODE&&e.hasAttribute(f)};TextHighlighter.prototype.serializeHighlights=function(){var e=this.getHighlights(),o=this.el,s=[];function getElementPath(e,t){var i=[],n;do{n=Array.prototype.slice.call(e.parentNode.childNodes);i.unshift(n.indexOf(e));e=e.parentNode}while(e!==t||!e);return i}sortByDepth(e,false);e.forEach(function(e){var t=0,i=e.textContent.length,n=getElementPath(e,o),r=e.cloneNode(true);r.innerHTML="";r=r.outerHTML;if(e.previousSibling&&e.previousSibling.nodeType===p.TEXT_NODE){t=e.previousSibling.length}s.push([r,e.textContent,n.join(":"),t,i])});return JSON.stringify(s)};TextHighlighter.prototype.deserializeHighlights=function(e){var t,a=[],l=this;if(!e){return a}try{t=JSON.parse(e)}catch(e){throw"Can't parse JSON: "+e}function deserializationFn(e){var t={wrapper:e[0],text:e[1],path:e[2].split(":"),offset:e[3],length:e[4]},i=t.path.pop(),n=l.el,r,o,s;while(!!(s=t.path.shift())){n=n.childNodes[s]}if(n.childNodes[i-1]&&n.childNodes[i-1].nodeType===p.TEXT_NODE){i-=1}n=n.childNodes[i];r=n.splitText(t.offset);r.splitText(t.length);if(r.nextSibling&&!r.nextSibling.nodeValue){g(r.nextSibling).remove()}if(r.previousSibling&&!r.previousSibling.nodeValue){g(r.previousSibling).remove()}o=g(r).wrap(g().fromHTML(t.wrapper)[0]);a.push(o)}t.forEach(function(e){try{deserializationFn(e)}catch(e){if(console&&console.warn){console.warn("Can't deserialize highlight descriptor. Cause: "+e)}}});return a};TextHighlighter.prototype.find=function(e,t){var i=g(this.el).getWindow(),n=i.scrollX,r=i.scrollY,o=typeof t==="undefined"?true:t;g(this.el).removeAllRanges();if(i.find){while(i.find(e,o)){this.doHighlight(true)}}else if(i.document.body.createTextRange){var s=i.document.body.createTextRange();s.moveToElementText(this.el);while(s.findText(e,1,o?4:0)){if(!g(this.el).contains(s.parentElement())&&s.parentElement()!==this.el){break}s.select();this.doHighlight(true);s.collapse(false)}}g(this.el).removeAllRanges();i.scrollTo(n,r)};TextHighlighter.createWrapper=function(e){var t=document.createElement("span");t.style.backgroundColor=e.color;t.className=e.highlightedClass;return t};e.TextHighlighter=TextHighlighter})(window);function XMLWriter(e,t){if(e)this.encoding=e;if(t)this.version=t}(function(){var e=XMLWriter.prototype={encoding:"UTF-8",version:"1.0",formatting:"indented",indentChar:"\t",indentation:1,newLine:"\n",writeStartDocument:function(e){this.close();this.stack=[];this.standalone=e},writeEndDocument:function(){this.active=this.root;this.stack=[]},writeDocType:function(e){this.doctype=e},writeStartElement:function(e,t){if(t)e=t+":"+e;var i={n:e,a:{},c:[]};if(this.active){this.active.c.push(i);this.stack.push(this.active)}else this.root=i;this.active=i},writeEndElement:function(){this.active=this.stack.pop()||this.root},writeAttributeString:function(e,t){if(this.active)this.active.a[e]=t},writeString:function(e){if(this.active)this.active.c.push(e)},writeXML:function(e){if(this.active)this.active.c.push(e)},writeElementString:function(e,t,i){this.writeStartElement(e,i).writeString(t).writeEndElement()},writeCDATA:function(e){e=e.replace(/>>]/g,"]]><![CDATA[>");this.writeString("<![CDATA["+e+"]]>")},writeComment:function(e){this.writeString("\x3c!-- "+e+" --\x3e")},flush:function(){this.writeEndDocument();var e="",t=this.indentation,i=this.formatting.toLowerCase()=="indented",n=['<?xml version="'+this.version+'" encoding="'+this.encoding+'"'];if(this.standalone!==undefined)n[0]+=' standalone="'+!!this.standalone+'"';n[0]+=" ?>";if(this.doctype&&this.root)n.push("<!DOCTYPE "+this.root.n+" "+this.doctype+">");if(i){while(t--)e+=this.indentChar}if(this.root)format(this.root,"",e,n);return n.join(i?this.newLine:"")},close:function(){if(this.root)clean(this.root);this.active=this.root=this.stack=null},getDocument:window.ActiveXObject?function(){var e=new ActiveXObject("Microsoft.XMLDOM");e.async=false;e.loadXML(this.flush());return e}:function(){return(new DOMParser).parseFromString(this.flush(),"text/xml")}};function clean(e){var t=e.c.length;while(t--){if(typeof e.c[t]=="object")clean(e.c[t])}e.n=e.a=e.c=null}function format(e,t,i,n){var r=t+"<"+e.n,o=e.c.length,s,a,l=0;for(s in e.a)r+=" "+s+'="'+e.a[s]+'"';r+=o?">":" />";n.push(r);if(o){do{a=e.c[l++];if(typeof a=="string"){if(o==1)return n.push(n.pop()+a+"</"+e.n+">");else n.push(t+i+a)}else if(typeof a=="object")format(a,t+i,i,n)}while(l<o);n.push(t+"</"+e.n+">")}}for(var t in e){if(typeof e[t]=="function"&&!/flush|getDocument/.test(t)){var i=e[t];e[t]=function(){arguments.callee._o_.apply(this,arguments);return this};e[t]._o_=i}}})();(function(e){e.activityTypes={assessment:"http://adlnet.gov/expapi/activities/assessment",attempt:"http://adlnet.gov/expapi/activities/attempt",course:"http://adlnet.gov/expapi/activities/course",file:"http://adlnet.gov/expapi/activities/file",cmiInteraction:"http://adlnet.gov/expapi/activities/cmi.interaction",interaction:"http://adlnet.gov/expapi/activities/interaction",lesson:"http://adlnet.gov/expapi/activities/lesson",link:"http://adlnet.gov/expapi/activities/link",media:"http://adlnet.gov/expapi/activities/media",meeting:"http://adlnet.gov/expapi/activities/meeting",module:"http://adlnet.gov/expapi/activities/module",objective:"http://adlnet.gov/expapi/activities/objective",performance:"http://adlnet.gov/expapi/activities/performance",profile:"http://adlnet.gov/expapi/activities/profile",question:"http://adlnet.gov/expapi/activities/question",simulation:"http://adlnet.gov/expapi/activities/simulation"}})(window.ADL=window.ADL||{});var cmi5Controller=function(){var r;var o;var s;var n;var a;var l;var i;var c;this.endPoint="";this.fetchUrl="";this.registration="";this.activityId="";this.actor="";this.authToken="";this.object="";this.sessionId="";this.masteryScore=0;this.launchMode="";this.launchMethod="";this.publisherId="";this.moveOn="";this.launchParameters="";this.returnURL="";this.entitlementKey={courseStructure:"",alternate:""};this.languagePreference="";this.audioPreference="";function GetBasicStatement(e,t){var i=new ADL.XAPIStatement(o,e,t);i.generateId();return i}function AuthTokenFetched(){cmi5Controller.getStateDocument(setStateDocument)}function SetConfig(){s={endpoint:cmi5Controller.endPoint,auth:"Basic "+cmi5Controller.authToken}}function setAgentProfile(e){if(e.response.languagePreference||e.response.audioPreference){var t=e.response;if(t.languagePreference){cmi5Controller.languagePreference=t.languagePreference}if(t.audioPreference){cmi5Controller.audioPreference=t.audioPreference}}else console.log("No agent profile found");c=Date.now();i()}function setStateDocument(e){if(e.response){var t=JSON.parse(e.response);l=t.contextTemplate;n=t.contextTemplate.contextActivities;a=t.contextTemplate.extensions;var i=typeof t["returnURL"];if(i==="string"){cmi5Controller.returnURL=t["returnURL"]}cmi5Controller.moveOn=t["moveOn"];cmi5Controller.masteryScore=t["masteryScore"];cmi5Controller.launchMode=t["launchMode"];cmi5Controller.launchMethod=t["launchMethod"];cmi5Controller.sessionId=a["https://w3id.org/xapi/cmi5/context/extensions/sessionid"];cmi5Controller.publisherId=n.grouping[0].id;cmi5Controller.launchParameters=t["launchParameters"];cmi5Controller.entitlementKey=t["entitlementKey"];cmi5Controller.getAgentProfile(setAgentProfile)}else{console.log("No state document found")}}return{startUp:function(e,t){i=e;cmi5Controller.object={objectType:"Activity",id:cmi5Controller.activityId};cmi5Controller.getAuthToken(AuthTokenFetched,t)},getAUActivityId:function(){return cmi5Controller.activityId},getMasteryScore:function(){return cmi5Controller.masteryScore},getReturnUrl:function(){return cmi5Controller.returnURL},getContextActivities:function(){return n},getContextExtensions:function(){return a},getStartDateTime:function(){return c},goLMS:function(){var e=cmi5Controller.getReturnUrl();if(typeof e=="string"&&e.length>0){var t=decodeURIComponent(e);document.location.href=t;return false}self.close();return false},setEndPoint:function(e){if(e){cmi5Controller.endPoint=e;console.log("Endpoint set to "+e)}else{console.log("Invalid value passed to setEndpoint()")}},setFetchUrl:function(e){if(e){cmi5Controller.fetchUrl=e;console.log("fetchUrl set to "+e)}else{console.log("Invalid value passed to setFetchUrl()")}},setObjectProperties:function(e,t,i,n){cmi5Controller.object.definition={};if(t){cmi5Controller.object.definition.type=t}if(!e)e="und";if(i){cmi5Controller.object.definition.name={};cmi5Controller.object.definition.name[e]=i}if(n){cmi5Controller.object.definition.description={};cmi5Controller.object.definition.description[e]=n}},setRegistration:function(e){if(e){cmi5Controller.registration=e;console.log("Registration set to "+e)}else{console.log("Invalid value passed to setRegistration()")}},setActivityId:function(e){if(e){cmi5Controller.activityId=e;console.log("Activity ID set to "+e)}else{console.log("Invalid value passed to setActivityId()")}},setActor:function(e){o=JSON.parse(e);if(e){if(o.objectType!=="Agent"){console.log("In cmi5, the actor must have an objectType of Agent.");return}if(o.account===null){console.log("In cmi5, the account property of an Agent is required.");return}if(!o.account.homePage){console.log("In cmi5, the homePage property of an account is required.");return}if(!o.account.name){console.log("In cmi5, the name property of an account is required.");return}cmi5Controller.agent=o}else{console.log("Invalid value passed to setActor()")}},getAuthToken:function(i,n){var e=sessionStorage.getItem(cmi5Controller.fetchUrl);if(e){cmi5Controller.authToken=e;SetConfig();if(i&&typeof i==="function"){i();return}}var r=new XMLHttpRequest;r.open("POST",cmi5Controller.fetchUrl,true);r.onreadystatechange=function(){if(this.readyState===4){if(this.status===200){var e=JSON.parse(r.responseText);var t=typeof e["error-code"];if(t==="string"){console.log("error-code "+e["error-code"]+": "+e["error-text"]);if(n&&typeof n==="function"){n("")}}t=typeof e["auth-token"];if(t==="string"){cmi5Controller.authToken=e["auth-token"];sessionStorage.setItem(cmi5Controller.fetchUrl,cmi5Controller.authToken);SetConfig();if(i&&typeof i==="function"){i()}}else{console.log("Invalid structure returned: "+e.toString());if(n&&typeof n==="function")n("")}}else console.log("Call to fetchUrl failed with status "+this.status.toString())}};r.send()},getAgentProfile:function(e){ADL.XAPIWrapper.changeConfig(s);ADL.XAPIWrapper.getAgentProfile(o,"cmi5LearnerPreferences",null,e)},getStateDocument:function(e){ADL.XAPIWrapper.changeConfig(s);ADL.XAPIWrapper.getState(cmi5Controller.activityId,o,"LMS.LaunchData",cmi5Controller.registration,null,e)},getcmi5AllowedStatement:function(e,t,i,n){r=GetBasicStatement(e,t);r.context={registration:cmi5Controller.registration};if(!i){i=cmi5Controller.getContextActivities()}if(!n){n=cmi5Controller.getContextExtensions()}if(typeof i!=="undefined"){if(i.hasOwnProperty("category")){delete i.category}}r.context.contextActivities=i;r.context.extensions=n;return r},getcmi5DefinedStatement:function(e,t){r=GetBasicStatement(e,cmi5Controller.object);if(!t){t=cmi5Controller.getContextExtensions()}r.context={registration:cmi5Controller.registration};var i=n;r.context.contextActivities=i;r.context.contextActivities.category=[];r.context.contextActivities.category.push({id:"https://w3id.org/xapi/cmi5/context/categories/cmi5"});r.context.extensions=t;return r},sendAllowedState:function(e,t,i,n,r){ADL.XAPIWrapper.changeConfig(s);ADL.XAPIWrapper.sendState(cmi5Controller.activityId,o,e,cmi5Controller.registration,t,i,n,r)},getAllowedState:function(e,t,i){ADL.XAPIWrapper.changeConfig(s);return ADL.XAPIWrapper.getState(cmi5Controller.activityId,o,e,cmi5Controller.registration,t,i)},sendStatement:function(e,t){if(window.statementsSent&&typeof window.statementsSent==="object"&&Array.isArray(window.statementsSent)){window.statementsSent.push(e)}ADL.XAPIWrapper.changeConfig(s);ADL.XAPIWrapper.sendStatement(e,t)}}}();var bookmarkingTracking=function(){this.pagesVisited=[];this.attemptDuration=0;this.pageDuration=0;this.attemptComplete=false;this.completed=false;this.pagesTotal=0;this.failed=false;this.passed=false;this.passedOrFailed=false;this.pageTitle="";this.progress=0;this.hls=[]};bookmarkingTracking.prototype={initFromBookmark:function(e){this.pagesVisited=e.pagesVisited;this.attemptDuration=e.attemptDuration;this.attemptComplete=e.attemptComplete;this.pagesTotal=e.pagesTotal;this.completed=e.completed;this.failed=e.failed;this.passed=e.passed;this.passedOrFailed=e.passedOrFailed;this.hls=e.hls},getAttemptDuration:function(){if(typeof this.attemptDuration==="string")this.attemptDuration=parseInt(this.attemptDuration);if(sessionStorage.getItem("pageDuration"))this.attemptDuration+=parseInt(sessionStorage.getItem("pageDuration"));sessionStorage.setItem("attemptDuration",this.attemptDuration);return this.attemptDuration},getPageDuration:function(){let e,t=[];if(sessionStorage.getItem("pageDurations"))t=JSON.parse(sessionStorage.getItem("pageDurations"));t.push(Math.abs(new Date));sessionStorage.setItem("pageDurations",JSON.stringify(t));if(t.length>1)e=t[t.length-1]-t[t.length-2];else e=t[0]-parseInt(sessionStorage.getItem("startTimeStamp"));sessionStorage.setItem("pageDuration",e);return e},goToBookmarkedPage:function(){let n=[];if(!sessionStorage.getItem("bookMarkInit")){sessionStorage.setItem("startTimeStamp",Math.abs(new Date));let e,t,i;e=this.getStatements("launched");i=this.getStatements("initialized");t=this.getStatements("satisfied");if(t>0)sessionStorage.setItem("satisfied",true);if(e<2||i<1)cmi5Controller.sendAllowedState("bookmarkingData",{});else n=cmi5Controller.getAllowedState("bookmarkingData")}else{if(sessionStorage.getItem("pagesTotal"))n.pagesTotal=parseInt(sessionStorage.getItem("pagesTotal"));if(sessionStorage.getItem("completed"))n.completed=sessionStorage.getItem("completed");if(sessionStorage.getItem("passed"))n.passed=sessionStorage.getItem("passed");if(sessionStorage.getItem("passedOrFailed"))n.passedOrFailed=sessionStorage.getItem("passedOrFailed");if(sessionStorage.getItem("failed"))n.failed=sessionStorage.getItem("failed");if(sessionStorage.getItem("pagesVisited"))n.pagesVisited=JSON.parse(sessionStorage.getItem("pagesVisited"));if(sessionStorage.getItem("attemptDuration"))n.attemptDuration=parseInt(sessionStorage.getItem("attemptDuration"));if(sessionStorage.getItem("attemptComplete"))n.attemptComplete=sessionStorage.getItem("attemptComplete")}console.log("launchMode set to: "+cmi5Controller.launchMode);if(n.hls)textHightlighting("","","",n.hls);if(typeof n.pagesVisited!=="undefined"){this.initFromBookmark(n);if(!sessionStorage.getItem("bookMarkInit"))resumeDialog()}else document.querySelector("body").style.display="block"},getStatements:function(e){let t,i=ADL.XAPIWrapper.searchParams(),n=cmi5Controller.agent.account;i["verb"]="http://adlnet.gov/expapi/verbs/"+e;i["agent"]='{ "account": { "homePage": "'+n.homePage+'", "name": "'+n.name+'" }}';i["registration"]=cmi5Controller.registration;ADL.XAPIWrapper.changeConfig({endpoint:cmi5Controller.endPoint,auth:"Basic "+cmi5Controller.authToken});t=ADL.XAPIWrapper.getStatements(i);if(t.statements.length<1){i["verb"]="https://w3id.org/xapi/adl/verbs/"+e;t=ADL.XAPIWrapper.getStatements(i)}return t.statements.length},getLaunched:function(e){let t,i=ADL.XAPIWrapper.searchParams(),n=cmi5Controller.agent.account;i["verb"]="http://adlnet.gov/expapi/verbs/"+e;i["agent"]='{ "account": { "homePage": "'+n.homePage+'", "name": "'+n.name+'" }}';i["registration"]=cmi5Controller.registration;ADL.XAPIWrapper.changeConfig({endpoint:cmi5Controller.endPoint,auth:"Basic "+cmi5Controller.authToken});t=ADL.XAPIWrapper.getStatements(i);if(t.statements.length<1){i["verb"]="https://w3id.org/xapi/adl/verbs/"+e;t=ADL.XAPIWrapper.getStatements(i)}return t.statements},getStatements_:function(e){var i=ADL.XAPIWrapper.searchParams();let t,n=cmi5Controller.agent.account,r,o,s,a=[],l={},c={},d={};i["verb"]="http://adlnet.gov/expapi/verbs/"+e;i["related_activities"]=true;i["related_agents"]=true;i["activity"]=cmi5Controller.activityId;ADL.XAPIWrapper.changeConfig({endpoint:cmi5Controller.endPoint,auth:"Basic "+cmi5Controller.authToken});i=ADL.XAPIWrapper.getStatements(i);function getSessions(e){e.more="/Modules/CmiXapi/xapiproxy.php"+e.more.slice(10);let t=ADL.XAPIWrapper.getStatements("",e.more);return t}function getMoreSessions(t){t=getSessions(t);for(let e=0;e<t.statements.length;e++){i.statements.push(t.statements[e])}return t}if(i.more&&i.more!==""){t=getSessions(i);for(let e=0;e<t.statements.length;e++){i.statements.push(t.statements[e])}do{t=getMoreSessions(t)}while(t.more&&t.more!=="")}i=i.statements;for(let e=0;e<i.length;e++){r=i[e].context.extensions["https://w3id.org/xapi/acrossx/activities/page"];if(r&&r===location.pathname)a.push(i[e])}for(let e=0;e<a.length;e++){r=a[e].actor.account.name;o=a[e].result.extensions["https://w3id.org/xapi/cmi5/result/extensions/progress"];s=parseISO8601Duration(a[e].result.duration);if(l.hasOwnProperty(r)){l[r]++;c[r]+=o;d[r]+=s}else{l[r]=1;c[r]=o;d[r]=s}}let u=Object.keys(c),f=[],p;cmi5Controller.st=[];cmi5Controller.st["vi"]=[];cmi5Controller.st["pr"]=[];cmi5Controller.st["du"]=[];for(let e=0;e<u.length;e++){if(l.hasOwnProperty(u[e])){c[u[e]]=parseInt(c[u[e]]/l[u[e]]);d[u[e]]=d[u[e]]/60;d[u[e]]=d[u[e]].toFixed(1);if(u[e]===n.name)p="Me and myself";else p="User "+(e+1);cmi5Controller.st.vi.push({name:p,value:l[u[e]]});cmi5Controller.st.pr.push({name:p,value:c[u[e]]});cmi5Controller.st.du.push({name:p,value:d[u[e]]})}}},resume:function(){if(this.pagesVisited.length>0)location.href=this.pagesVisited[1]},saveBookmarkingData:function(e){let t,i=location.pathname,n;if(e){n=this.getCurrentPage(this.pagesVisited,i);if(n<0&&!sessionStorage.getItem("bookMarkInit"))this.pagesVisited.push(i);else{if(n>-1)this.pagesVisited.splice(n,1);this.pagesVisited.unshift(i)}this.getAttemptDuration();sessionStorage.setItem("pagesVisited",JSON.stringify(this.pagesVisited));if(sessionStorage.getItem("completed"))this.completed=true;if(sessionStorage.getItem("failed"))this.failed=true;if(sessionStorage.getItem("passed"))this.passed=true;if(sessionStorage.getItem("passedOrFailed"))this.passedOrFailed=true}t={pagesVisited:JSON.parse(sessionStorage.getItem("pagesVisited")),attemptDuration:sessionStorage.getItem("attemptDuration"),attemptComplete:sessionStorage.getItem("attemptComplete"),pagesTotal:sessionStorage.getItem("pagesTotal"),completed:sessionStorage.getItem("completed"),failed:sessionStorage.getItem("failed"),passed:sessionStorage.getItem("passed"),passedOrFailed:sessionStorage.getItem("passedOrFailed"),hls:textHightlighting("","",true)};cmi5Controller.sendAllowedState("bookmarkingData",t)},getCurrentPage:function(t,i,n){if(n)for(let e=0;e<t.length;e++){if(t[e][n]===i)return e}else for(let e=0;e<t.length;e++){if(t[e]==i)return e}return-1},checkMoveOn:function(e,t){let i=100;if(cmi5Controller.masteryScore)i=cmi5Controller.masteryScore*100;if(sessionStorage.getItem("pagesTotal"))this.pagesTotal=parseInt(sessionStorage.getItem("pagesTotal"));function moveOnPassed(){if(sessionStorage.getItem("passed")){sendDefinedStatementWrapper("Passed",parseFloat(sessionStorage.getItem("score")),bm.attemptDuration)}else if(sessionStorage.getItem("failed")){sendDefinedStatementWrapper("Failed",parseFloat(sessionStorage.getItem("score")),bm.attemptDuration)}}function moveOnCompleted(){if(bm.progress>=i){sendDefinedStatementWrapper("Completed","",bm.attemptDuration);sessionStorage.setItem("satisfied",true)}}if(this.pagesTotal>0){if(!sessionStorage.getItem("satisfied")){switch(e.toUpperCase()){case"PASSED":moveOnPassed();break;case"COMPLETED":moveOnCompleted();break;case"COMPLETEDANDPASSED":moveOnPassed();moveOnCompleted();break;case"COMPLETEDORPASSED":moveOnPassed();moveOnCompleted();break}}if(this.progress&&!t)sendAllowedStatementWrapper("Progressed","",this.getPageDuration(),this.progress)}},markMenuItems:function(){let n=document.querySelectorAll(".main-navbarnav a[target=_self]"),r=document.querySelectorAll(".main-navbarnav .nav-item > a"),e=document.querySelectorAll(".progress-bar"),t=document.querySelector("body").id,o,i,s=[];if(sessionStorage.getItem("bookMarkInit")&&sessionStorage.getItem("startPageId")!=t){for(let i=0;i<n.length;i++){o=n[i];if(!sessionStorage.getItem("pagesTotal"))s.push(o);if(o.classList.contains("active")){o.classList.add("visited");this.pageTitle=o.innerHTML.trim();if(i<n.length-1)document.querySelector(".page-pagination").style.display="block"}if(!o.classList.contains("check-mark")&&!o.parentNode.classList.contains("nav-item")){let e=document.createElement("i"),t=document.createElement("span");e.classList.add("fas","fa-check");t.classList.add("check-mark");o.insertBefore(t,o.childNodes[0]);o.firstChild.appendChild(e);for(let e=0;e<this.pagesVisited.length;e++){if(n[i].getAttribute("href").indexOf(this.pagesVisited[e])!=-1&&!o.classList.contains("visited")){n[i].classList.add("visited");o.classList.add("visited")}}}}}let a='<progress-circle value="" offset="top" pull="-150" part="chart"><slice part="background" size="100%" stroke-width="150" radius="75" stroke="#fff" fill="transparent">\x3c!--No label--\x3e</slice><slice part="circle" x="438" y="64" size="',l='%" stroke-width="',c='" radius="75" stroke="#fff">\x3c!--No label--\x3e</slice></progress-circle>';for(let n=0;n<r.length;n++){if(!r[n].classList.contains("progress-circle")){if(!r[n].classList.contains("dropdown-toggle"))r[n].insertAdjacentHTML("afterbegin",a+100+l+150+c);else{let t=0,i=r[n].nextSibling.childNodes.length;for(let e=0;e<i;e++){if(r[n].nextSibling.childNodes[e].classList.contains("visited"))t++}if(t>0)r[n].insertAdjacentHTML("afterbegin",a+t/i*100+l+150+c);else r[n].insertAdjacentHTML("afterbegin",a+t/i*100+l+0+c)}r[n].classList.add("progress-circle")}}if(sessionStorage.getItem("bookMarkInit")&&sessionStorage.getItem("startPageId")!=t&&!sessionStorage.getItem("pagesTotal"))sessionStorage.setItem("pagesTotal",s.length);this.progress=parseInt(this.pagesVisited.length/parseInt(sessionStorage.getItem("pagesTotal"))*100);if(e.length>0){e[0].style.width=this.progress+"%";e[0].innerHTML=this.progress+"%"}}};var bm=new bookmarkingTracking;document.addEventListener("DOMContentLoaded",()=>{customizeTemplate();if(document.querySelectorAll(".course-login").length>0){sessionStorage.setItem("courseLoggedIn",0);document.getElementById("main-navbar").classList.add("d-none")}if(!sessionStorage.getItem("cmi5Parms"))getCmi5Parms();else if(location.href.indexOf("endpoint")==-1&&parseInt(sessionStorage.getItem("courseLoggedIn"))>0){window.history.replaceState(null,null,"?"+sessionStorage.getItem("cmi5Parms"))}if(sessionStorage.getItem("cmi5No")=="false"&&location.href.indexOf("endpoint")!=-1){cmi5Controller.setEndPoint(parse("endpoint"));cmi5Controller.setFetchUrl(parse("fetch"));cmi5Controller.setRegistration(parse("registration"));cmi5Controller.setActivityId(parse("activityid"));cmi5Controller.setActor(parse("actor"));cmi5Controller.startUp(cmi5Ready,startUpError)}});function cmi5Ready(){let t=JSON.parse(sessionStorage.getItem("cmi5ObjectProperties"));cmi5Controller.setObjectProperties(t[0],t[1],t[2],t[3]);cmi5Controller.dLang=t[0];cmi5Controller.dTitle='"'+t[2]+'"';sessionStorage.setItem("endPoint",cmi5Controller.endPoint);sessionStorage.setItem("auth","Basic "+cmi5Controller.authToken);if(parseInt(sessionStorage.getItem("courseLoggedIn"))>0){if(!sessionStorage.getItem("cmi5Init")){let e=bm.getLaunched("launched");e=e[0].context.contextActivities.grouping[0].definition;t[0]=Object.keys(e.name)[0];t[2]=e.name[t[0]];t[3]=e.description[t[0]];sessionStorage.setItem("courseTitle",t[2]);cmi5Controller.dLang=t[0];cmi5Controller.dTitle='"'+t[2]+'"';sessionStorage.setItem("cmi5ObjectProperties",JSON.stringify(t));sendDefinedStatementWrapper("Initialized");sessionStorage.setItem("cmi5Init","true");sessionStorage.setItem("cmi5No","false")}bookmarkingAndProgress();if(!sessionStorage.getItem("bookMarkInit"))document.querySelector("body").style.display="block";if(document.querySelectorAll("video").length>0){let t=document.querySelectorAll("video"),i=cmi5Controller.getContextExtensions();for(let e=0;e<t.length;e++){trackVideoEvents(t[e],i)}}}else feLogIn()}function feLogIn(){sessionStorage.setItem("courseLoggedIn",1);let e=document.querySelectorAll(".course-login form")[0],t=e.querySelectorAll("input"),i=e.querySelectorAll("fieldset button"),n="devuser3j8d03mx7";courseId="devuser";e.setAttribute("autocomplete","off");if(n.length>100)n=n.substring(0,100);if(courseId.length>100)courseId=courseId.substring(0,100);for(let e=0;e<t.length;e++){t[e].type="hidden";if(t[e].name=="user")t[e].value=courseId;if(t[e].name=="pass")t[e].value=n;if(t[e].name=="submit")t[e].click()}if(i.length>0)i[0].click()}function scroll(e){console.log(e);let t=Math.max(document.documentElement.scrollTop,document.body.scrollTop);if(!t){if(scrollUp<1)scrollUp++;else document.querySelector(".prev-page .page-link").click()}else if(t+document.documentElement.clientHeight>=document.documentElement.scrollHeight){if(scrollDown<1)scrollDown++;else document.querySelector(".next-page .page-link").click()}}var navbar=false,scrollDown=scrollUp=0;function customizeTemplate(){document.querySelector("html").setAttribute("lang","de");let e='<div class="btn styled rules-au-button"><i class="fas fa-exclamation"></i></div>',t='<div class="btn styled notes-au-button"><i class="fas fa-pen"></i></div>',i='<div class="btn-close btn btn-close-white styled exit-au-button"></div>',y=document.querySelectorAll("#main-navbar .container"),n=document.querySelectorAll(".offcanvas-header"),r=document.querySelectorAll(".offcanvas-body"),o=document.querySelector("body").id,s=document.querySelectorAll(".pagination .page-item");if(y.length>0){navbar=true;y[0].insertAdjacentHTML("beforeend",e);y[0].insertAdjacentHTML("beforeend",t);y[0].insertAdjacentHTML("beforeend",i)}if(s.length>0){if(s.length>1){s[0].style.display="none";s[0].classList.add("prev-page");s[1].classList.add("next-page")}else s[0].classList.add("next-page");let e=document.querySelectorAll(".pagination .next-page.page-item a"),t=document.querySelectorAll(".pagination .next-page.page-item a span");e[0].innerHTML="Weiter";e[0].appendChild(t[0]);let i=document.querySelectorAll(".pagination .next-page.page-item a span i");i[0].className="";i[0].classList.add("fas","fa-chevron-down");e[0].classList.add("text-center","text-grid")}if(document.querySelector("footer.start-page")){if(!sessionStorage.getItem("startPageId"))sessionStorage.setItem("startPageId",o);if(s.length>0)s[0].style.display="none";if(document.querySelector("#main-navbar")){document.querySelector("#main-navbar").style.display="none";document.querySelector("#page-footer").classList.remove("py-4")}if(document.querySelectorAll(".start-button")){document.querySelector(".start-button").addEventListener("click",function(){document.querySelector(".next-page .page-link").click()})}let i=document.querySelectorAll(".jumbotron.background-image");if(i.length>0){i=i[0];let e=i.currentStyle||window.getComputedStyle(i,false),t=e.backgroundImage;t="linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), "+t;i.insertAdjacentHTML("beforebegin","<style> #"+i.id+".jumbotron {background-image: "+t+"!important}</style>");sessionStorage.setItem("jumbotron",t)}}else if(r.length>0){r[0].classList.add("fs-4","fw-light");r[0].insertAdjacentHTML("afterbegin",'<div class="progress"><div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div></div>');n[0].insertAdjacentHTML("afterbegin",'<div class="module-title fs-4 fw-light" style="background-image:"></div>')}setTimeout(function(){let e=document.querySelectorAll(".offcanvas-header .module-title"),t=document.querySelectorAll(".modal .exit-au-button"),i=document.querySelectorAll(".modal .resume-button"),n=document.querySelectorAll(".navbar .rules-au-button"),r=document.querySelector(".navbar .notes-au-button"),o=document.querySelectorAll(".navbar .exit-au-button"),s=document.querySelectorAll("#page-content .exit-au-button"),a=document.querySelectorAll(".container button.modal-notes"),l=document.querySelectorAll(".container button.modal-rules"),c=document.querySelectorAll(".modal .close-button"),d=document.querySelectorAll("button.btn-close"),u=document.getElementById("page-content"),f=document.querySelector(".jumbotron"),p=document.querySelector(".summary-highlights");let h=document.querySelectorAll(".video iframe"),g=document.querySelectorAll(".video video"),m=cmi5Controller.getContextExtensions(),v=[];if(h.length>0){for(let e=0;e<h.length;e++){trackVideoEvents(h[e],m,"vimeoOrYtObserver"+e)}}if(g.length>0){for(let e=0;e<g.length;e++){v[e]=new Plyr(g[e]);trackVideoEvents(g[e],m)}}if(y.length>0&&!f)textHightlighting(u,r);if(p)summaryHighlights();if(e.length>0){e[0].style.backgroundImage=sessionStorage.getItem("jumbotron");e[0].innerHTML=sessionStorage.getItem("courseTitle")}if(a.length==0&&r)r.style.color="rgba(255,255,255,0.5)";if(l.length==0&&n.length>0)n[0].style.color="rgba(255,255,255,0.5)";if(c.length>0){for(let e=0;e<c.length;e++){for(let e=0;e<d.length;e++){d[e].classList.add("btn-close-white")}c[e].addEventListener("click",function(){for(let e=0;e<d.length;e++){d[e].click()}})}}if(t.length>0)t[0].addEventListener("click",function(){exitAU()});if(i.length>0)i[0].addEventListener("click",function(){bm.resume()});if(n.length>0)n[0].addEventListener("click",function(){modalRulesDialog()});if(o.length>0)o[0].addEventListener("click",function(){exitAUDialog()});if(s.length>0)s[0].addEventListener("click",function(){exitAUDialog()})},100)}function textHightlighting(e,t,i,n){var r=location.pathname;if(n){for(let e=0;e<n.length;e++){sessionStorage.setItem(Object.keys(n[e])[0],Object.values(n[e])[0])}}else if(i){var o=[];for(let e=0;e<sessionStorage.length;e++){if(sessionStorage.key(e)==="hl___"+r)cmi5Controller.hltr.deserializeHighlights(sessionStorage.getItem(sessionStorage.key(e)));if(sessionStorage.key(e).indexOf("hl___")!=-1){o.push({[sessionStorage.key(e)]:sessionStorage.getItem(sessionStorage.key(e))})}}return o}else{setTimeout(function(){let e=document.querySelector("iframe.h5p-iframe");if(e)cmi5Controller.hltrIframe=new TextHighlighter(e.contentDocument.body)},500);cmi5Controller.hltr=new TextHighlighter(e);e.addEventListener("click",function(){if(!r.indexOf("lerngruppe")!=-1)sessionStorage.setItem("hl___"+r,cmi5Controller.hltr.serializeHighlights())});t.addEventListener("click",function(){cmi5Controller.hltr.removeHighlights();cmi5Controller.hltrIframe.removeHighlights();sessionStorage.removeItem("hl___"+r);sessionStorage.removeItem("hli___"+r)})}}function summaryHighlights(){function rem(e){return e.replace(/<\/?SPAN[^>]*>/gi,"").replace(/<\/?i[^>]*>/gi,"").replace(/<\/?svg[^>]*>/gi,"").replace(/<\/?style[^>]*>/gi,"").replace(/<\/?path[^>]*>/gi,"")}setTimeout(function(){var t,e=location.pathname,i="",n=document.querySelectorAll(".navbar-nav.main-navbarnav .dropdown-item");for(let e=0;e<sessionStorage.length;e++){if(sessionStorage.key(e).indexOf("hl___")!=-1&&sessionStorage.key(e).indexOf("lerngruppe")==-1&&sessionStorage.key(e).indexOf("zusammenfassung")==-1){t=sessionStorage.key(e).substring(5);for(let e=0;e<n.length;e++){if(n[e].href.indexOf(t)!=-1){i+="<div><a href='"+t+"'>"+rem(n[e].innerHTML).trim()+"</a></div>"}}}}document.querySelector(".summary-highlights p").insertAdjacentHTML("afterend",i)},500)}function exitAUDialog(){document.querySelector(".btn.exit-dialog").click()}function resumeDialog(){document.querySelector("body").style.display="block";sendAllowedStatementWrapper("Resumed");document.querySelector(".btn.resume-dialog").click()}function modalNotesDialog(){let e=document.querySelectorAll(".container button.modal-notes");if(e.length>0)e[0].click();else alert("Keine Notizen hier ...")}function modalRulesDialog(){let e=document.querySelectorAll(".container button.modal-rules");if(e.length>0)e[0].click();else alert("Keine Merksätze hier ...")}function getCmi5Parms(){if(location.href.indexOf("endpoint")!=-1){let e=[];e=location.href.split("?");if(location.href.indexOf("&cHash")!=-1)e=e[1].split("&cHash");sessionStorage.setItem("cmi5Parms",e[1]);sessionStorage.setItem("cmi5No","false")}else sessionStorage.setItem("cmi5No","true")}function bookmarkingAndProgress(){if(document.querySelector(".jumbotron-content .text-light"))document.querySelector(".jumbotron-content .text-light").innerHTML=sessionStorage.getItem("courseTitle");bm.goToBookmarkedPage();bm.markMenuItems();setTimeout(function(){bm.saveBookmarkingData(true)},200);bm.checkMoveOn(cmi5Controller.moveOn);if(!sessionStorage.getItem("bookMarkInit"))sessionStorage.setItem("bookMarkInit","true")}function startUpError(){alert("An error was detected in the cmi5Controller.startUp() method.  Please check the console log for any errors.")}function sendAllowedStatementWrapper(e,t,r,o,s){let a=e.toUpperCase(),l=cmi5Controller.getContextExtensions(),c;switch(a){case"EXPERIENCED":c=ADL.verbs.experienced;break;case"PROGRESSED":c=ADL.verbs.progressed;break;case"RESUMED":c=ADL.verbs.resumed;break;case"SUSPENDED":c=ADL.verbs.suspended;break;case"HIGHLIGHTED":c=ADL.verbs.highlighted;break}if(cmi5Controller.launchMode.toUpperCase()!=="NORMAL"){console.log("When launchMode is "+cmi5Controller.launchMode+"only Initialized and Terminated verbs are allowed");return false}if(c){let e,t=convertMillisecondsToMinSec(r),i=JSON.parse(sessionStorage.getItem("stmtObject"));i.id+="_"+location.hostname+location.pathname;e=cmi5Controller.getcmi5AllowedStatement(c,i,cmi5Controller.getContextActivities(),l);e.object.definition.name={[cmi5Controller.dLang]:cmi5Controller.dTitle+" at page "+'"'+bm.pageTitle+'", duration: '+t};if(a==="RESUMED")e.object.definition.name={[cmi5Controller.dLang]:cmi5Controller.dTitle};if(a==="SUSPENDED")e.object.definition.name={[cmi5Controller.dLang]:cmi5Controller.dTitle+" at page "+'"'+bm.pageTitle+'"'};if(a==="PROGRESSED")e.object.definition.name={[cmi5Controller.dLang]:cmi5Controller.dTitle+" at page "+'"'+bm.pageTitle+'"'+", progress: "+o+"%"};if(a==="HIGHLIGHTED")e.object.definition.name={[cmi5Controller.dLang]:cmi5Controller.dTitle+" at page "+'"'+bm.pageTitle+'"'+", Text highlighted ..."};e.timestamp=(new Date).toISOString();if(r||o){e.result={};if(typeof o==="number")e.result.extensions={"https://w3id.org/xapi/cmi5/result/extensions/progress":o};if(r)e.result.duration=convertMillisecondsToISO8601Duration(r)}let n={"https://w3id.org/xapi/acrossx/activities/page":location.pathname};if(s){n={"https://w3id.org/xapi/acrossx/activities/page":location.pathname,"http://risc-inc.com/annotator/activities/highlight":s}}Object.assign(l,n);e.context.extensions=l;cmi5Controller.sendStatement(e)}else console.log("Invalid verb passed: "+e);return false}function sendDefinedStatementWrapper(o,s,a,l){let c=o.toUpperCase(),d;switch(c){case"INITIALIZED":d=ADL.verbs.initialized;break;case"COMPLETED":d=ADL.verbs.completed;break;case"PASSED":d=ADL.verbs.passed;break;case"FAILED":d=ADL.verbs.failed;break;case"TERMINATED":d=ADL.verbs.terminated;break}if(cmi5Controller.launchMode.toUpperCase()!=="NORMAL"){if(c!=="TERMINATED"&&c!=="INITIALIZED"){console.log("When launchMode is "+cmi5Controller.launchMode+"only Initialized and Terminated verbs are allowed");return false}}if(d){let e=cmi5Controller.getContextExtensions(),t,i=null,n,r=convertMillisecondsToMinSec(a);if(c==="PASSED"||c==="FAILED"){if(cmi5Controller.masteryScore&&!e["https://w3id.org/xapi/cmi5/context/extensions/masteryscore"])e["https://w3id.org/xapi/cmi5/context/extensions/masteryscore"]=cmi5Controller.masteryScore;t=c==="PASSED"}if(c==="COMPLETED")i=true;n=cmi5Controller.getcmi5DefinedStatement(d,e);if(!sessionStorage.getItem("stmtObject"))sessionStorage.setItem("stmtObject",JSON.stringify(n.object));if(c==="INITIALIZED")n.object.definition.name={[cmi5Controller.dLang]:cmi5Controller.dTitle};else n.object.definition.name={[cmi5Controller.dLang]:cmi5Controller.dTitle+" at page "+'"'+bm.pageTitle+'"'};if(c==="TERMINATED")n.object.definition.name={[cmi5Controller.dLang]:cmi5Controller.dTitle+" at page "+'"'+bm.pageTitle+'", session duration: '+r};if(c==="COMPLETED")n.object.definition.name={[cmi5Controller.dLang]:cmi5Controller.dTitle+" at page "+'"'+bm.pageTitle+'", attempt duration: '+r};n.timestamp=(new Date).toISOString();if(t||i||s||a||l){n.result={};if(typeof i==="boolean")n.result.completion=i;if(typeof t==="boolean")n.result.success=t;if(typeof s==="number")n.result.score={scaled:s};if(a)n.result.duration=convertMillisecondsToISO8601Duration(a);if(t||i||o==="Failed")n.context.contextActivities.category.push({id:"https://w3id.org/xapi/cmi5/context/categories/moveon"})}cmi5Controller.sendStatement(n)}else console.log("Invalid verb passed: "+o);return false}function exitAU(){finishAU()}function finishAU(){let e=Math.abs(new Date)-parseInt(sessionStorage.getItem("startTimeStamp"));if(cmi5Controller.launchMode.toUpperCase()==="NORMAL")sendAllowedStatementWrapper("Suspended","",e);bm.checkMoveOn(cmi5Controller.moveOn,true);bm.saveBookmarkingData(false);sendDefinedStatementWrapper("Terminated","",e);sessionStorage.clear();cmi5Controller.goLMS()}function parse(t){let i=result_="Not found",n=[];t=t.toUpperCase();location.search.substr(1).split("&").forEach(function(e){n=e.split("=");if(n[0].toUpperCase()===t)i=decodeURIComponent(n[1])});return i}function convertMillisecondsToISO8601Duration(e){let t,i,n,r,o=parseInt(e,10),s="",a="";r=Math.round(o/10);if(r<0){s="-";r=r*-1}t=parseInt(r/36e4,10);i=parseInt(r%36e4/6e3,10);n=r%36e4%6e3/100;a=s+"PT";if(t>0)a+=t+"H";if(i>0)a+=i+"M";return a+=n+"S"}function convertMillisecondsToMinSec(e){let t=(e/1e3).toFixed(0),i=Math.floor(t/60),n="";if(i>59){n=Math.floor(i/60);n=n>=10?n:"0"+n;i=i-n*60;i=i>=10?i:"0"+i}t=Math.floor(t%60);t=t>=10?t:"0"+t;if(n!="")return n+":"+i+":"+t;else return i+":"+t}function parseISO8601Duration(e){let t=/(-)?P(?:([.,\d]+)Y)?(?:([.,\d]+)M)?(?:([.,\d]+)W)?(?:([.,\d]+)D)?T(?:([.,\d]+)H)?(?:([.,\d]+)M)?(?:([.,\d]+)S)?/;let i=e.match(t);if(i[1]===undefined)i[1]="+";else i[1]="-";if(i[2]===undefined)i[2]=0;if(i[3]===undefined)i[3]=0;if(i[4]===undefined)i[4]=0;if(i[5]===undefined)i[5]=0;if(i[6]===undefined)i[6]=0;if(i[7]===undefined)i[7]=0;if(i[8]===undefined)i[8]=0;let n=parseInt(i[4])*604800+parseInt(i[5])*86400+parseInt(i[6])*2400+parseInt(i[7])*60+parseInt(i[8]);return n}function trackVideoEvents(n,o,e){var D,e;if(e){e=new window.IntersectionObserver(([e])=>{if(e.isIntersecting){window.addEventListener("message",onMessageReceived,false);console.log("added :"+n.src);return}window.removeEventListener("message",onMessageReceived,false);console.log("removed :"+n.src)},{root:null,threshold:1})}function vSections(t,e,i,n){t.push({t1:e,t2:i});t.sort(function(e,t){return e.t1-t.t1});var r=0,o=0,s=[],a=[];for(let e=0;e<t.length;e++){if(e<t.length-1){if(parseFloat(t[e].t2)<parseFloat(t[e+1].t1)){r+=parseFloat(t[e+1].t1)-parseFloat(t[e].t2);s.push({t1:t[e].t2,t2:t[e+1].t1})}}else{r+=n-parseFloat(t[e].t2);s.push({t1:t[e].t2,t2:n})}}o=(n-r).toFixed(2);r=r.toFixed(2);for(let e=0;e<s.length;e++){if(e>0){a.push({t1:s[e-1].t2,t2:s[e].t1})}else{a.push({t1:"0.0",t2:s[e].t1})}}return a}function sendPaused(e,t,i,n){console.log("paused");let r={extensions:{"https://w3id.org/xapi/video/extensions/time":e,"https://w3id.org/xapi/video/extensions/progress":(t/i).toFixed(2),"https://w3id.org/xapi/video/extensions/played-segments":n.substr(0,n.length-2)}};console.log(r);sendVideoStatement("paused",this,r,o)}function sendPlayed(e){console.log("played");let t={extensions:{"https://w3id.org/xapi/video/extensions/time":e}};console.log(t);sendVideoStatement("played",this,t,o)}function sendFinished(e){console.log("finished");let t={score:{scaled:1,min:0,max:100,raw:100},success:true,completion:true,response:"",duration:ISO8601_time(e)};console.log(t);sendVideoStatement("ended",this,t,o)}function sendSeeked(e,t){console.log("seeked");let i={extensions:{"https://w3id.org/xapi/video/extensions/time-from":e,"https://w3id.org/xapi/video/extensions/time-to":t}};console.log(i);sendVideoStatement("seeked",this,i,o);return[e,t]}if(n.src&&n.src.indexOf("youtube")!=-1){if(n.src.indexOf("-nocookie")!=-1){}var t="",i=0,r="",s=0,a=0,l=0,c=0,d=[],u=[0,0,0,0,0],f={},p=[],O=[],L=function(){return JSON.stringify({event:"listening",func:"info",args:[]})};n.contentWindow.postMessage(L(),"*");window.addEventListener("message",onMessageReceived,false);setTimeout(function(){e.observe(n)},900);function onMessageReceived(e){let t=JSON.parse(e.data);if("info"in t){if(t.info){if("currentTime"in t.info)onSeek(t.info);if("playerState"in t.info){switch(t.info.playerState){case 2:onPause(t.info);break;case 0:onFinish(t.info);break;case 1:onPlay(t.info);break}}}}}function onPause(e){if(c==0)c=parseFloat(e.duration).toFixed(2);l=a;if(d.length>1&&d[0]=="played")l=f[0];if(s==l)s=p[0];t+=s+" - "+l+", ";i+=l-s;sendPaused(l,i,c,t);O=vSections(O,s,l,c);d=[]}function onPlay(e){d.push("played");s=u[3];p.push(s);if(p.length>2)p.shift();if(r!==null){let e=new Date;r=e.getTime()}sendPlayed(a)}function onSeek(e){u.push(parseFloat(e.currentTime).toFixed(2));if(u.length>5)u.shift();a=u[4];if(Math.abs(u[4]-u[3])>1){s=u[3];f=sendSeeked(s,a);d.push("seeked")}}function onFinish(e){sendFinished(r)}return}if(n.src&&n.src.indexOf("vimeo")!=-1){var P="",k=0,h=0,g=false,R=[],m="",v=0,y=[0,0,0,0,0],H=0,S=0,b=0;window.addEventListener("message",onMessageReceived,false);setTimeout(function(){e.observe(n)},900);function onMessageReceived(e){var t=JSON.parse(e.data);switch(t.event){case"ready":onReady();break;case"pause":onPause(t.data);break;case"finish":onFinish(t.data);break;case"seek":onSeek(t.data);break;case"play":onPlay(t.data);break;case"playProgress":onPlayProgress(t.data);break}}function post(e,t){let i={method:e};if(t)i.value=t;n.contentWindow.postMessage(JSON.stringify(i),"*")}function onReady(){post("addEventListener","pause");post("addEventListener","finish");post("addEventListener","seek");post("addEventListener","play");post("addEventListener","playProgress")}function onPlayProgress(e){y.push(parseFloat(e.seconds).toFixed(2));if(y.length>5)y.shift();S=y[4]}function onPause(e){if(e)h=parseFloat(e.duration).toFixed(2);if(g){b=v;v=H}else if(S>v){b=S;P+=v+" - "+b+", ";k+=b-v;sendPaused(b,k,h,P)}R=vSections(R,v,b,h);g=false}function onPlay(e){v=S;if(m!==null){let e=new Date;m=e.getTime()}sendPlayed(S)}function onSeek(e){g=true;H=v;v=y[2];sendSeeked(v,S);post("pause");onPause(e)}function onFinish(e){sendFinished(m)}return}if(n.poster){var N="",x="",C=0,w=[0,0,0,0,0],M=0,A=0,I=0,j=0,T=0,U=[],E=false;n.ontimeupdate=function(){w.push(parseFloat(this.currentTime).toFixed(2));if(w.length>5)w.shift();A=w[4]};n.onseeked=function(){E=true;M=C;C=w[2];sendSeeked(C,A);n.pause();n.onpause()};n.onpause=function(){T=parseFloat(this.duration).toFixed(2);if(E){I=C;C=M}else{I=A;N+=C+" - "+I+", ";j+=I-C;sendPaused(I,j,T,N)}U=vSections(U,C,I,T);E=false};n.onplay=function(){C=A;if(x!==null){let e=new Date;x=e.getTime()}sendPlayed(A)};n.onended=function(){sendFinished(x)}}function ISO8601_time(e){let t=new Date;return"PT"+Math.round(t.getTime()/1e3-e/1e3)+"S"}}function sendVideoStatement(e,r,o,s){let t=e.toUpperCase(),a,l=document.querySelectorAll("video source")[0].getAttribute("src"),c=l;l=l.substring(l.lastIndexOf("/")+1);switch(t){case"SEEKED":a=ADL.verbs.seeked;break;case"PAUSED":a=ADL.verbs.paused;break;case"PLAYED":a=ADL.verbs.played;break;case"INTERACTED":a=ADL.verbs.initeracted;break;case"TERMINATED":a=ADL.verbs.terminated;break;case"EXPERIENCED":a=ADL.verbs.experienced;break;case"INITIALIZED":a=ADL.verbs.initialized;break;case"ENDED":a=ADL.verbs.ended;break}if(cmi5Controller.launchMode.toUpperCase()!=="NORMAL"){console.log("When launchMode is "+cmi5Controller.launchMode+"only Initialized and Terminated verbs are allowed");return false}if(a){let e,t,i=[],n=JSON.parse(sessionStorage.getItem("stmtObject"));n.id+="_"+location.hostname+location.pathname;i={id:n.id+"_"+c,objectType:"Activity",definition:{type:"https://w3id.org/xapi/video/activity-type/video",name:{"en-US":l}}};t={"https://w3id.org/xapi/video/extensions/length":r.duration,"https://w3id.org/xapi/video/extensions/full-screen":r.fullscreenchange,"https://w3id.org/xapi/video/extensions/screen-size":window.innerWidth+" x "+window.innerHeight,"https://w3id.org/xapi/video/extensions/video-playback-size":r.videoWidth+" x "+r.videoHeight,"https://w3id.org/xapi/video/extensions/quality":r.videoWidth+" x "+r.videoHeight,"https://w3id.org/xapi/video/extensions/user-agent":navigator.userAgent,"https://w3id.org/xapi/video/extensions/volume":r.volume,"https://w3id.org/xapi/acrossx/activities/page":location.pathname};e=cmi5Controller.getcmi5AllowedStatement(a,i,cmi5Controller.getContextActivities(),t);Object.assign(s,t);e.context.extensions=s;e.object.definition.name={[cmi5Controller.dLang]:cmi5Controller.dTitle+': "'+l+'"'+" at page "+'"'+bm.pageTitle+'"'};e.result={}=o;e.timestamp=(new Date).toISOString();cmi5Controller.sendStatement(e)}else console.log("Invalid verb passed: "+e);return false}var H5Pinit=true,H5Ptitle,handleH5P=function(e){if(cmi5Controller.launchMode.toUpperCase()!=="NORMAL"){console.log("When launchMode is "+cmi5Controller.launchMode+"only Initialized and Terminated verbs are allowed");return false}let t=e.data.statement,i,n,r,o=H5PIntegration.contents[Object.keys(H5PIntegration.contents)[0]].mainId,s=JSON.parse(sessionStorage.getItem("stmtObject"));if(cmi5Controller.getContextExtensions()){s.id+="/"+location.hostname+location.pathname+"/h5pcid_"+o+t.object.id;t.object.id=s.id;if(H5Pinit){H5Ptitle=window[0].window.H5P.instances[0].libraryInfo.machineName;H5Pinit=false}t.object.definition.name={[cmi5Controller.dLang]:cmi5Controller.dTitle+': "'+H5Ptitle+": "+o+'"'+" at page "+'"'+bm.pageTitle+'"'};r=cmi5Controller.getcmi5AllowedStatement(t.verb,t.object,cmi5Controller.getContextActivities(),cmi5Controller.getContextExtensions());if(t.result){r.result=t.result;if(t.result.completion&&cmi5Controller.masteryScore&&(!sessionStorage.getItem("passed")&&!sessionStorage.getItem("failed"))){sessionStorage.setItem("score",t.result.score.scaled);if(parseFloat(t.result.score.scaled)>=parseFloat(cmi5Controller.masteryScore))sessionStorage.setItem("passed",true);else sessionStorage.setItem("failed",true)}}cmi5Controller.sendStatement(r)}};document.onreadystatechange=function(){if(sessionStorage.getItem("cmi5Init")||sessionStorage.getItem("cmi5No")=="true")document.querySelector("body").style.display="block";else document.querySelector("body").style.display="none";if("complete"===document.readyState&&typeof H5P!=="undefined"&&H5P.externalDispatcher&&cmi5Controller&&sessionStorage.getItem("cmi5No")=="false")H5P.externalDispatcher.on("xAPI",handleH5P)};function saveFileAs(){if(promptFilename=prompt("Datei speichern","cmi5.xml")){var e=new Blob([document.querySelector(".parsedxml").value],{type:"text/plain"});var t=document.createElement("a");t.download=promptFilename;t.innerHTML="Download File";t.href=window.URL.createObjectURL(e);t.click();delete t;delete e}}function cmi5Xml(e){let t=new XMLWriter("UTF-8");t.formatting="indented";t.indentChar=" ";t.indentation=2;t.writeStartDocument();t.writeStartElement("courseStructure");t.writeAttributeString("xmlns","https://w3id.org/xapi/profiles/cmi5/v1/CourseStructure.xsd");t.writeStartElement("course");t.writeAttributeString("id",e.cmiDatamodelCourseId);t.writeStartElement("title");t.writeStartElement("langstring");t.writeString(e.cmiDatamodelCourseTitle);t.writeAttributeString("lang",e.cmiObjpropLang);t.writeEndElement();t.writeEndElement();t.writeStartElement("description");t.writeStartElement("langstring");t.writeString(e.cmiDatamodelCourseDescr);t.writeAttributeString("lang",e.cmiObjpropLang);t.writeEndElement();t.writeEndElement();t.writeEndElement();t.writeStartElement("au");t.writeAttributeString("id",e.cmiDatamodelAuId);t.writeAttributeString("moveOn",e.cmiDatamodelAuMoveon);t.writeAttributeString("masteryScore",e.cmiDatamodelAuMasteryscore);t.writeStartElement("title");t.writeStartElement("langstring");t.writeString(e.cmiDatamodelAuTitle);t.writeAttributeString("lang",e.cmiObjpropLang);t.writeEndElement();t.writeEndElement();t.writeStartElement("description");t.writeStartElement("langstring");t.writeString(e.cmiDatamodelAuDescr);t.writeAttributeString("lang",e.cmiObjpropLang);t.writeEndElement();t.writeEndElement();t.writeElementString("url",window.location.href);t.writeEndElement();t.writeEndElement();t.writeEndElement();t.writeEndDocument();return t.flush()}var CryptoJS=CryptoJS||function(u,i){var e={};var t=e.lib={};var n=t.Base=function(){function F(){}return{extend:function(e){F.prototype=this;var t=new F;if(e){t.mixIn(e)}if(!t.hasOwnProperty("init")){t.init=function(){t.$super.init.apply(this,arguments)}}t.init.prototype=t;t.$super=this;return t},create:function(){var e=this.extend();e.init.apply(e,arguments);return e},init:function(){},mixIn:function(e){for(var t in e){if(e.hasOwnProperty(t)){this[t]=e[t]}}if(e.hasOwnProperty("toString")){this.toString=e.toString}},clone:function(){return this.init.prototype.extend(this)}}}();var f=t.WordArray=n.extend({init:function(e,t){e=this.words=e||[];if(t!=i){this.sigBytes=t}else{this.sigBytes=e.length*4}},toString:function(e){return(e||o).stringify(this)},concat:function(e){var t=this.words;var i=e.words;var n=this.sigBytes;var r=e.sigBytes;this.clamp();if(n%4){for(var o=0;o<r;o++){var s=i[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=s<<24-(n+o)%4*8}}else if(i.length>65535){for(var o=0;o<r;o+=4){t[n+o>>>2]=i[o>>>2]}}else{t.push.apply(t,i)}this.sigBytes+=r;return this},clamp:function(){var e=this.words;var t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8;e.length=u.ceil(t/4)},clone:function(){var e=n.clone.call(this);e.words=this.words.slice(0);return e},random:function(e){var t=[];for(var i=0;i<e;i+=4){t.push(u.random()*4294967296|0)}return new f.init(t,e)}});var r=e.enc={};var o=r.Hex={stringify:function(e){var t=e.words;var i=e.sigBytes;var n=[];for(var r=0;r<i;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16));n.push((o&15).toString(16))}return n.join("")},parse:function(e){var t=e.length;var i=[];for(var n=0;n<t;n+=2){i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4}return new f.init(i,t/2)}};var s=r.Latin1={stringify:function(e){var t=e.words;var i=e.sigBytes;var n=[];for(var r=0;r<i;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){var t=e.length;var i=[];for(var n=0;n<t;n++){i[n>>>2]|=(e.charCodeAt(n)&255)<<24-n%4*8}return new f.init(i,t)}};var a=r.Utf8={stringify:function(e){try{return decodeURIComponent(escape(s.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return s.parse(unescape(encodeURIComponent(e)))}};var l=r.Base64={stringify:function(e){var t=e.words;var i=e.sigBytes;var n=this._map;e.clamp();var r=[];for(var o=0;o<i;o+=3){var s=t[o>>>2]>>>24-o%4*8&255;var a=t[o+1>>>2]>>>24-(o+1)%4*8&255;var l=t[o+2>>>2]>>>24-(o+2)%4*8&255;var c=s<<16|a<<8|l;for(var d=0;d<4&&o+d*.75<i;d++){r.push(n.charAt(c>>>6*(3-d)&63))}}var u=n.charAt(64);if(u){while(r.length%4){r.push(u)}}return r.join("")},parse:function(e){var t=e.length;var i=this._map;var n=i.charAt(64);if(n){var r=e.indexOf(n);if(r!=-1){t=r}}var o=[];var s=0;for(var a=0;a<t;a++){if(a%4){var l=i.indexOf(e.charAt(a-1))<<a%4*2;var c=i.indexOf(e.charAt(a))>>>6-a%4*2;o[s>>>2]|=(l|c)<<24-s%4*8;s++}}return f.create(o,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};var c=t.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=new f.init;this._nDataBytes=0},_append:function(e){if(typeof e=="string"){e=a.parse(e)}this._data.concat(e);this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data;var i=t.words;var n=t.sigBytes;var r=this.blockSize;var o=r*4;var s=n/o;if(e){s=u.ceil(s)}else{s=u.max((s|0)-this._minBufferSize,0)}var a=s*r;var l=u.min(a*4,n);if(a){for(var c=0;c<a;c+=r){this._doProcessBlock(i,c)}var d=i.splice(0,a);t.sigBytes-=l}return new f.init(d,l)},clone:function(){var e=n.clone.call(this);e._data=this._data.clone();return e},_minBufferSize:0});var d=t.Hasher=c.extend({cfg:n.extend(),init:function(e){this.cfg=this.cfg.extend(e);this.reset()},reset:function(){c.reset.call(this);this._doReset()},update:function(e){this._append(e);this._process();return this},finalize:function(e){if(e){this._append(e)}var t=this._doFinalize();return t},blockSize:512/32,_createHelper:function(i){return function(e,t){return new i.init(t).finalize(e)}},_createHmacHelper:function(i){return function(e,t){return new p.HMAC.init(i,t).finalize(e)}}});var p=e.algo={};var h=[];var g=p.SHA1=d.extend({_doReset:function(){this._hash=new f.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){var i=this._hash.words;var n=i[0];var r=i[1];var o=i[2];var s=i[3];var a=i[4];for(var l=0;l<80;l++){if(l<16){h[l]=e[t+l]|0}else{var c=h[l-3]^h[l-8]^h[l-14]^h[l-16];h[l]=c<<1|c>>>31}var d=(n<<5|n>>>27)+a+h[l];if(l<20){d+=(r&o|~r&s)+1518500249}else if(l<40){d+=(r^o^s)+1859775393}else if(l<60){d+=(r&o|r&s|o&s)-1894007588}else{d+=(r^o^s)-899497514}a=s;s=o;o=r<<30|r>>>2;r=n;n=d}i[0]=i[0]+n|0;i[1]=i[1]+r|0;i[2]=i[2]+o|0;i[3]=i[3]+s|0;i[4]=i[4]+a|0},_doFinalize:function(){var e=this._data;var t=e.words;var i=this._nDataBytes*8;var n=e.sigBytes*8;t[n>>>5]|=128<<24-n%32;t[(n+64>>>9<<4)+14]=u.floor(i/4294967296);t[(n+64>>>9<<4)+15]=i;e.sigBytes=t.length*4;this._process();return this._hash},clone:function(){var e=d.clone.call(this);e._hash=this._hash.clone();return e}});e.SHA1=d._createHelper(g);e.HmacSHA1=d._createHmacHelper(g);return e}(Math);var CryptoJS=CryptoJS||function(a,i){var e={},t=e.lib={},n=function(){},r=t.Base={extend:function(e){n.prototype=this;var t=new n;e&&t.mixIn(e);t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)});t.init.prototype=t;t.$super=this;return t},create:function(){var e=this.extend();e.init.apply(e,arguments);return e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=t.WordArray=r.extend({init:function(e,t){e=this.words=e||[];this.sigBytes=t!=i?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,i=e.words,n=this.sigBytes;e=e.sigBytes;this.clamp();if(n%4)for(var r=0;r<e;r++)t[n+r>>>2]|=(i[r>>>2]>>>24-8*(r%4)&255)<<24-8*((n+r)%4);else if(65535<i.length)for(r=0;r<e;r+=4)t[n+r>>>2]=i[r>>>2];else t.push.apply(t,i);this.sigBytes+=e;return this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-8*(t%4);e.length=a.ceil(t/4)},clone:function(){var e=r.clone.call(this);e.words=this.words.slice(0);return e},random:function(e){for(var t=[],i=0;i<e;i+=4)t.push(4294967296*a.random()|0);return new l.init(t,e)}}),o=e.enc={},s=o.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;n<e;n++){var r=t[n>>>2]>>>24-8*(n%4)&255;i.push((r>>>4).toString(16));i.push((r&15).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n+=2)i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-4*(n%8);return new l.init(i,t/2)}},c=o.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;n<e;n++)i.push(String.fromCharCode(t[n>>>2]>>>24-8*(n%4)&255));return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n++)i[n>>>2]|=(e.charCodeAt(n)&255)<<24-8*(n%4);return new l.init(i,t)}},d=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},u=t.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new l.init;this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e));this._data.concat(e);this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,i=t.words,n=t.sigBytes,r=this.blockSize,o=n/(4*r),o=e?a.ceil(o):a.max((o|0)-this._minBufferSize,0);e=o*r;n=a.min(4*e,n);if(e){for(var s=0;s<e;s+=r)this._doProcessBlock(i,s);s=i.splice(0,e);t.sigBytes-=n}return new l.init(s,n)},clone:function(){var e=r.clone.call(this);e._data=this._data.clone();return e},_minBufferSize:0});t.Hasher=u.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e);this.reset()},reset:function(){u.reset.call(this);this._doReset()},update:function(e){this._append(e);this._process();return this},finalize:function(e){e&&this._append(e);return this._doFinalize()},blockSize:16,_createHelper:function(i){return function(e,t){return new i.init(t).finalize(e)}},_createHmacHelper:function(i){return function(e,t){return new f.HMAC.init(i,t).finalize(e)}}});var f=e.algo={};return e}(Math);(function(r){for(var e=CryptoJS,t=e.lib,i=t.WordArray,n=t.Hasher,t=e.algo,o=[],h=[],s=function(e){return 4294967296*(e-(e|0))|0},a=2,l=0;64>l;){var c;e:{c=a;for(var d=r.sqrt(c),u=2;u<=d;u++)if(!(c%u)){c=!1;break e}c=!0}c&&(8>l&&(o[l]=s(r.pow(a,.5))),h[l]=s(r.pow(a,1/3)),l++);a++}var g=[],t=t.SHA256=n.extend({_doReset:function(){this._hash=new i.init(o.slice(0))},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],l=i[5],c=i[6],d=i[7],u=0;64>u;u++){if(16>u)g[u]=e[t+u]|0;else{var f=g[u-15],p=g[u-2];g[u]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+g[u-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+g[u-16]}f=d+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&c)+h[u]+g[u];p=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&r^n&o^r&o);d=c;c=l;l=a;a=s+f|0;s=o;o=r;r=n;n=f+p|0}i[0]=i[0]+n|0;i[1]=i[1]+r|0;i[2]=i[2]+o|0;i[3]=i[3]+s|0;i[4]=i[4]+a|0;i[5]=i[5]+l|0;i[6]=i[6]+c|0;i[7]=i[7]+d|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32;t[(n+64>>>9<<4)+14]=r.floor(i/4294967296);t[(n+64>>>9<<4)+15]=i;e.sigBytes=4*t.length;this._process();return this._hash},clone:function(){var e=n.clone.call(this);e._hash=this._hash.clone();return e}});e.SHA256=n._createHelper(t);e.HmacSHA256=n._createHmacHelper(t)})(Math);(function(){var e=CryptoJS,c=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init;"string"==typeof t&&(t=c.parse(t));var i=e.blockSize,n=4*i;t.sigBytes>n&&(t=e.finalize(t));t.clamp();for(var r=this._oKey=t.clone(),o=this._iKey=t.clone(),s=r.words,a=o.words,l=0;l<i;l++)s[l]^=1549556828,a[l]^=909522486;r.sigBytes=o.sigBytes=n;this.reset()},reset:function(){var e=this._hasher;e.reset();e.update(this._iKey)},update:function(e){this._hasher.update(e);return this},finalize:function(e){var t=this._hasher;e=t.finalize(e);t.reset();return t.finalize(this._oKey.clone().concat(e))}})})();(function(e){if(typeof e.TextEncoder==="undefined"){function StringToCodePointAt(e,t){if(String.prototype.codePointAt)return e.codePointAt(t);e=String(e);var i=e.length;var n=t?Number(t):0;if(n!=n){n=0}if(n<0||n>=i){return undefined}var r=e.charCodeAt(n);var o;if(r>=55296&&r<=56319&&i>n+1){o=e.charCodeAt(n+1);if(o>=56320&&o<=57343){return(r-55296)*1024+o-56320+65536}}return r}function TextEncoder(e){if(!e)e="utf8";switch(e){case"utf-8":case"utf8":break;default:throw"TextEncoder only supports utf8"}}TextEncoder.prototype.encode=function(e){var t=new Uint8Array(e.length*3);var i=-1;var n=e.length;var r=0;while(r<n){var o=StringToCodePointAt(e,r);var s=0;var a=0;if(o<=127){s=0;a=0}else if(o<=2047){s=6;a=192}else if(o<=65535){s=12;a=224}else if(o<=2097151){s=18;a=240}t[i+=1]=a|o>>s;s-=6;while(s>=0){t[i+=1]=128|o>>s&63;s-=6}r+=o>=65536?2:1}return t.subarray(0,i+1)};e.TextEncoder=TextEncoder}if(typeof e.TextDecoder==="undefined"){function StringFromCodePoint(e){if(String.fromCodePoint)return String.fromCodePoint(e);var t=[],i=0,n="";for(var r=0,o=arguments.length;r!==o;++r){var s=+arguments[r];if(!(s<1114111&&s>>>0===s))throw RangeError("Invalid code point: "+s);if(s<=65535){i=t.push(s)}else{s-=65536;i=t.push((s>>10)+55296,s%1024+56320)}if(i>=16383){n+=String.fromCharCode.apply(null,t);t.length=0}}return n+String.fromCharCode.apply(null,t)}function TextDecoder(e){if(!e)e="utf8";switch(e){case"utf-8":case"utf8":break;default:throw"TextDecoder only supports utf8"}}TextDecoder.prototype.decode=function(e){var t="";var i=0;while(i<e.length){var n=e[i];var r=0;var o=0;if(n<=127){r=0;o=n&255}else if(n<=223){r=1;o=n&31}else if(n<=239){r=2;o=n&15}else if(n<=244){r=3;o=n&7}if(e.length-i-r>0){var s=0;while(s<r){n=e[i+s+1];o=o<<6|n&63;s+=1}}else{o=65533;r=e.length-i}t+=StringFromCodePoint(o);i+=r+1}return t};e.TextDecoder=TextDecoder}})(this);(function(e){e.verbs={abandoned:{id:"https://w3id.org/xapi/adl/verbs/abandoned",display:{"en-US":"abandoned"}},answered:{id:"http://adlnet.gov/expapi/verbs/answered",display:{"de-DE":"beantwortete","en-US":"answered","fr-FR":"a répondu","es-ES":"contestó","ar-AR":"أجاب"}},asked:{id:"http://adlnet.gov/expapi/verbs/asked",display:{"de-DE":"fragte","en-US":"asked","fr-FR":"a demandé","es-ES":"preguntó","ar-AR":"طلب"}},attempted:{id:"http://adlnet.gov/expapi/verbs/attempted",display:{"de-DE":"versuchte","en-US":"attempted","fr-FR":"a essayé","es-ES":"intentó","ar-AR":"حاول"}},attended:{id:"http://adlnet.gov/expapi/verbs/attended",display:{"de-DE":"nahm teil an","en-US":"attended","fr-FR":"a suivi","es-ES":"asistió","ar-AR":"حضر"}},commented:{id:"http://adlnet.gov/expapi/verbs/commented",display:{"de-DE":"kommentierte","en-US":"commented","fr-FR":"a commenté","es-ES":"comentó","ar-AR":"علق"}},completed:{id:"http://adlnet.gov/expapi/verbs/completed",display:{"de-DE":"beendete","en-US":"completed","fr-FR":"a terminé","es-ES":"completó","ar-AR":"أكمل"}},exited:{id:"http://adlnet.gov/expapi/verbs/exited",display:{"de-DE":"verließ","en-US":"exited","fr-FR":"a quitté","es-ES":"salió","ar-AR":"خرج"}},experienced:{id:"http://adlnet.gov/expapi/verbs/experienced",display:{"de-DE":"erlebte","en-US":"experienced","fr-FR":"a éprouvé","es-ES":"experimentó","ar-AR":"شاهد"}},failed:{id:"http://adlnet.gov/expapi/verbs/failed",display:{"de-DE":"verfehlte","en-US":"failed","fr-FR":"a échoué","es-ES":"fracasó","ar-AR":"فشل"}},imported:{id:"http://adlnet.gov/expapi/verbs/imported",display:{"de-DE":"importierte","en-US":"imported","fr-FR":"a importé","es-ES":"importó","ar-AR":"مستورد"}},initialized:{id:"http://adlnet.gov/expapi/verbs/initialized",display:{"de-DE":"initialisierte","en-US":"initialized","fr-FR":"a initialisé","es-ES":"inicializó","ar-AR":"بدأ"}},interacted:{id:"http://adlnet.gov/expapi/verbs/interacted",display:{"de-DE":"interagierte","en-US":"interacted","fr-FR":"a interagi","es-ES":"interactuó","ar-AR":"تفاعل"}},launched:{id:"http://adlnet.gov/expapi/verbs/launched",display:{"de-DE":"startete","en-US":"launched","fr-FR":"a lancé","es-ES":"lanzó","ar-AR":"أطلق"}},mastered:{id:"http://adlnet.gov/expapi/verbs/mastered",display:{"de-DE":"meisterte","en-US":"mastered","fr-FR":"a maîtrisé","es-ES":"dominó","ar-AR":"أتقن"}},passed:{id:"http://adlnet.gov/expapi/verbs/passed",display:{"de-DE":"bestand","en-US":"passed","fr-FR":"a réussi","es-ES":"aprobó","ar-AR":"نجح"}},preferred:{id:"http://adlnet.gov/expapi/verbs/preferred",display:{"de-DE":"bevorzugte","en-US":"preferred","fr-FR":"a préféré","es-ES":"prefirió","ar-AR":"فضل"}},progressed:{id:"http://adlnet.gov/expapi/verbs/progressed",display:{"de-DE":"machte Fortschritt mit","en-US":"progressed","fr-FR":"a progressé","es-ES":"progresó","ar-AR":"تقدم"}},registered:{id:"http://adlnet.gov/expapi/verbs/registered",display:{"de-DE":"registrierte","en-US":"registered","fr-FR":"a enregistré","es-ES":"registró","ar-AR":"سجل"}},responded:{id:"http://adlnet.gov/expapi/verbs/responded",display:{"de-DE":"reagierte","en-US":"responded","fr-FR":"a répondu","es-ES":"respondió","ar-AR":"استجاب"}},resumed:{id:"http://adlnet.gov/expapi/verbs/resumed",display:{"de-DE":"setzte fort","en-US":"resumed","fr-FR":"a repris","es-ES":"continuó","ar-AR":"استأنف"}},satisfied:{id:"https://w3id.org/xapi/adl/verbs/satisfied",display:{"de-DE":"befriedigt","en-US":"satisfied","fr-FR":"satisfaite","es-ES":"satisfecho","ar-AR":"راض"}},scored:{id:"http://adlnet.gov/expapi/verbs/scored",display:{"de-DE":"erreichte","en-US":"scored","fr-FR":"a marqué","es-ES":"anotó","ar-AR":"سحل النقاط"}},shared:{id:"http://adlnet.gov/expapi/verbs/shared",display:{"de-DE":"teilte","en-US":"shared","fr-FR":"a partagé","es-ES":"compartió","ar-AR":"شارك"}},suspended:{id:"http://adlnet.gov/expapi/verbs/suspended",display:{"de-DE":"pausierte","en-US":"suspended","fr-FR":"a suspendu","es-ES":"aplazó","ar-AR":"علق"}},terminated:{id:"http://adlnet.gov/expapi/verbs/terminated",display:{"de-DE":"beendete","en-US":"terminated","fr-FR":"a terminé","es-ES":"terminó","ar-AR":"أنهى"}},voided:{id:"http://adlnet.gov/expapi/verbs/voided",display:{"de-DE":"entwertete","en-US":"voided","fr-FR":"a annulé","es-ES":"anuló","ar-AR":"فرغ"}},waived:{id:"https://w3id.org/xapi/adl/verbs/waived",display:{"de-DE":"verzichtet","en-US":"waived","fr-FR":"renoncé","es-ES":"renunciado","ar-AR":"تخلى"}},seeked:{id:"https://w3id.org/xapi/video/verbs/seeked",display:{"de-DE":"suchte","en-US":"seeked","fr-FR":"","es-ES":"","ar-AR":""}},played:{id:"https://w3id.org/xapi/video/verbs/played",display:{"de-DE":"spielte","en-US":"played","fr-FR":"","es-ES":"","ar-AR":""}},paused:{id:"https://w3id.org/xapi/video/verbs/paused",display:{"de-DE":"pausierte","en-US":"paused","fr-FR":"","es-ES":"","ar-AR":""}},ended:{id:"https://w3id.org/xapi/video/verbs/ended",display:{"de-DE":"beendete","en-US":"ended","fr-FR":"","es-ES":"","ar-AR":""}},highlighted:{id:"https://w3id.org/xapi/adb/verbs/highlighted",display:{"de-DE":"markierte","en-US":"highlighted","fr-FR":"","es-ES":"","ar-AR":""}}}})(window.ADL=window.ADL||{});(function(e){var c=e;function getQueryVariable(e){var t=window.location.search.substring(1);var i=t.split("&");for(var n=0;n<i.length;n++){var r=i[n].split("=");if(decodeURIComponent(r[0])==e){return decodeURIComponent(r[1])}}}function cb_wrap(n){return function(){var i=arguments;window.setTimeout(function(){var e=[];for(var t=0;t<i.length;t++){e.push(i[t])}n.apply(window,e)},0)}}function observeForNewLinks(){var e=document.body;var t=new MutationObserver(function(e){e.forEach(function(e){for(var t in e.addedNodes){if(e.addedNodes.hasOwnProperty(t)){if(e.addedNodes[t].constructor==HTMLAnchorElement){var i=e.addedNodes[t];setupCourseLinks([i])}}}})});var i={attributes:true,childList:true,subtree:true};t.observe(e,i)}function setupCourseLinks(e){var t=getQueryVariable("xAPILaunchKey");var i=getQueryVariable("xAPILaunchService");var n=getQueryVariable("encrypted");var r="xAPILaunchKey="+t+"&xAPILaunchService="+i;if(n){r+="&encrypted=true"}for(var o=0;o<e.length;o++){var s=e[o];var a=s.href;var l=s.attributes.getNamedItem("courselink");if(l&&l.value=="true"){if(a.indexOf("?")>-1){a=a+"&"+r}else a=a+"?"+r;s.href=a}}}function xAPILaunch(o,s,a){o=cb_wrap(o);try{var n=getQueryVariable("xAPILaunchKey");var r=getQueryVariable("xAPILaunchService");var e=getQueryVariable("encrypted");if(e){}xAPILaunch.terminate=function(e){var t=new URL(r);t.pathname+="launch/"+n+"/terminate";var i=new XMLHttpRequest;i.withCredentials=true;i.crossDomain=true;i.open("POST",t.toString(),false);i.setRequestHeader("Content-type","application/json");i.send(JSON.stringify({code:0,description:e||"User closed content"}))};if(!n||!r)return o("invalid launch parameters");var t=new URL(r);t.pathname+="launch/"+n;var l=new XMLHttpRequest;l.withCredentials=true;l.crossDomain=true;l.onerror=function(e){window.setTimeout(function(){return o(e)})};l.onload=function(e){if(l.status!==200){return l.onerror(l.responseText)}var t=JSON.parse(l.responseText);var i=t;var n={};n["endpoint"]=i.endpoint;n["actor"]=i.actor;n.withCredentials=true;n.strictCallbacks=a||false;window.onunload=function(){if(!s)return;xAPILaunch.terminate("User closed content")};var r=new c.XAPIWrapper.constructor;r.changeConfig(n);setupCourseLinks(document.body.querySelectorAll("a"));observeForNewLinks();return o(null,t,r)};l.open("POST",t.toString(),true);l.send()}catch(e){o(e)}}c.launch=xAPILaunch})(window.ADL=window.ADL||{});(function(e){var s=e;var t=false;if(typeof window!=="undefined"){s=window.ADL=e.ADL||{};t=true}var n=function(e){if(e.definition&&e.definition.name){return s.xapiutil.getLangVal(e.definition.name)}return undefined};var r=function(e){if(e.objectType!=="SubStatement")return;if(e.object.objectType==="SubStatement")return;if(e.id||e.stored||e.version||e.authority)return;var t=s.xapiutil.getActorId(e.actor)+":"+s.xapiutil.getVerbDisplay(e.verb)+":"+s.xapiutil.getObjectId(e.object);return t};s.xapiutil={};s.xapiutil.getLang=function(){var e;if(typeof navigator!=="undefined")e=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;else if(typeof process!=="undefined"&&typeof process.env!=="undefined"&&typeof process.env.LANG!=="undefined"){var t=process.env.LANG;e=t.slice(0,t.indexOf("."));e=e.replace(/_/,"-")}return e||"en-US"};s.xapiutil.getLangVal=function(e){if(!e)return;var t=Object.keys(e);if(t.length==0)return undefined;var i=s.xapiutil.getLang(),n,r=false;do{if(e[i]){n=e[i];r=true}else if(i.indexOf("-")){i=i.substring(0,i.lastIndexOf("-"))}}while(!r&&i!=="");return n};s.xapiutil.getMoreStatements=function(i,n,r){if(!t)throw new Error("Node not supported.");var o=[];s.XAPIWrapper.getStatements(r,null,function getMore(e){if(!(e&&e.response))return;var t=JSON.parse(e.response);if(!t.statements)return;o=o.concat(t.statements);if(i--<=0){n(o)}else{if(t.more&&t.more!==""){s.XAPIWrapper.getStatements(r,t.more,getMore)}else if(t.more===""){n(o)}}})};s.xapiutil.getActorId=function(e){return e.mbox||e.openid||e.mbox_sha1sum||e.account};s.xapiutil.getActorIdString=function(e){var t=e.mbox||e.openid||e.mbox_sha1sum;if(!t){if(e.account)t=e.account.homePage+":"+e.account.name;else if(e.member)t="Anon Group "+e.member;else t="unknown"}return t};s.xapiutil.getActorDisplay=function(e){return e.name||s.xapiutil.getActorIdString(e)};s.xapiutil.getVerbDisplay=function(e){if(!e)return;if(e.display){return s.xapiutil.getLangVal(e.display)||e.id}return e.id};s.xapiutil.getObjectType=function(e){return e.objectType||(e.id?"Activity":"Agent")};s.xapiutil.getObjectId=function(e){if(e.id)return e.id;var t=s.xapiutil.getObjectType(e);if(t==="Agent"||t==="Group")return s.xapiutil.getActorId(e);return undefined};s.xapiutil.getObjectIdString=function(e){if(!e)return"unknown";if(e.id)return e.id;var t=s.xapiutil.getObjectType(e);if(t==="Agent"||t==="Group")return s.xapiutil.getActorIdString(e);else if(t=="SubStatement"){return r(e)}return"unknown"};s.xapiutil.getObjectDisplay=function(e){if(!e)return"unknown";var t=n(e)||e.name||e.id;if(!t){var i=s.xapiutil.getObjectType(e);if(i==="Agent"||i=="Group")t=s.xapiutil.getActorDisplay(e);else if(i=="SubStatement"){t=r(e)}}return t}})(this);(function(s){function _getobj(e,t){var i=t.split(".");var n=i[0];t=i.slice(1).join(".");if(!e[n]){if(/\[\]$/.test(n)){n=n.slice(0,-2);if(!Array.isArray(e[n])){e[n]=[]}}else e[n]={}}if(!t)return e[n];else return _getobj(e[n],t)}var n=function(e,t,i,n){if(e&&e.actor&&e.verb&&e.object){var r=e;for(var o in r){if(o!="actor"&&o!="verb"&&o!="object")this[o]=r[o]}e=r.actor;t=r.verb;i=r.object}if(e){if(e instanceof a)this.actor=e;else if(e.objectType==="Agent"||!e.objectType)this.actor=new a(e);else if(e.objectType==="Group")this.actor=new l(e)}else this.actor=null;if(t){if(t instanceof c)this.verb=t;else this.verb=new c(t)}else this.verb=null;if(i){if(i.objectType==="Activity"||!i.objectType){if(i instanceof d)this.object=i;else this.object=new d(i)}else if(i.objectType==="Agent"){if(i instanceof a)this.object=i;else this.object=new a(i)}else if(i.objectType==="Group"){if(i instanceof l)this.object=i;else this.object=new l(i)}else if(i.objectType==="StatementRef"){if(i instanceof u)this.object=i;else this.object=new u(i)}else if(i.objectType==="SubStatement"){if(i instanceof f)this.object=i;else this.object=new f(i)}else this.object=null}else this.object=null;if(n){this.result=n}this.generateId=function(){this.id=s.ruuid()}};n.prototype.toString=function(){return this.actor.toString()+" "+this.verb.toString()+" "+this.object.toString()+" "+this.result.toString()};n.prototype.isValid=function(){return this.actor&&this.actor.isValid()&&this.verb&&this.verb.isValid()&&this.object&&this.object.isValid()&&this.result&&this.result.isValid()};n.prototype.generateRegistration=function(){_getobj(this,"context").registration=s.ruuid()};n.prototype.addParentActivity=function(e){_getobj(this,"context.contextActivities.parent[]").push(new d(e))};n.prototype.addGroupingActivity=function(e){_getobj(this,"context.contextActivities.grouping[]").push(new d(e))};n.prototype.addOtherContextActivity=function(e){_getobj(this,"context.contextActivities.other[]").push(new d(e))};var a=function(e,t){this.objectType="Agent";this.name=t;if(e&&(e.mbox||e.mbox_sha1sum||e.openid||e.account)){for(var i in e){this[i]=e[i]}}else if(/^mailto:/.test(e)){this.mbox=e}else if(/^[0-9a-f]{40}$/i.test(e)){this.mbox_sha1sum=e}else if(/^http[s]?:/.test(e)){this.openid=e}else if(e&&e.homePage&&e.name){this.account=e}};a.prototype.toString=function(){return this.name||this.mbox||this.openid||this.mbox_sha1sum||this.account.name};a.prototype.isValid=function(){return this.mbox||this.mbox_sha1sum||this.openid||this.account.homePage&&this.account.name||this.objectType==="Group"&&this.member};var l=function(e,t,i){a.call(this,e,i);this.member=t;this.objectType="Group"};l.prototype=new a;var c=function(e,t){if(e&&e.id){for(var i in e){this[i]=e[i]}return}this.id=e;if(t){if(typeof t==="string"||t instanceof String){this.display={"en-US":t}}else{this.display=t}}};c.prototype.toString=function(){if(this.display&&(this.display["en-US"]||this.display["en"]))return this.display["en-US"]||this.display["en"];else return this.id};c.prototype.isValid=function(){return this.id};var d=function(e,t,i){if(e&&e.id){var n=e;for(var r in n){this[r]=n[r]}return}this.objectType="Activity";this.id=e;if(t||i){this.definition={};if(typeof t==="string"||t instanceof String)this.definition.name={"en-US":t};else if(t)this.definition.name=t;if(typeof i==="string"||i instanceof String)this.definition.description={"en-US":i};else if(i)this.definition.description=i}};d.prototype.toString=function(){if(this.definition&&this.definition.name&&(this.definition.name["en-US"]||this.definition.name["en"]))return this.definition.name["en-US"]||this.definition.name["en"];else return this.id};d.prototype.isValid=function(){return this.id&&(!this.objectType||this.objectType==="Activity")};var u=function(e){if(e&&e.id){for(var t in e){this[t]=e[t]}}else{this.objectType="StatementRef";this.id=e}};u.prototype.toString=function(){return"statement("+this.id+")"};u.prototype.isValid=function(){return this.id&&this.objectType&&this.objectType==="StatementRef"};var f=function(e,t,i){n.call(this,e,t,i);this.objectType="SubStatement";delete this.id;delete this.stored;delete this.version;delete this.authority};f.prototype=new n;f.prototype.toString=function(){return'"'+f.prototype.prototype.toString.call(this)+'"'};n.Agent=a;n.Group=l;n.Verb=c;n.Activity=d;n.StatementRef=u;n.SubStatement=f;s.XAPIStatement=n})(window.ADL=window.ADL||{});if(!Date.prototype.toISOString){(function(){function pad(e){var t=String(e);if(t.length===1){t="0"+t}return t}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+pad(this.getUTCMonth()+1)+"-"+pad(this.getUTCDate())+"T"+pad(this.getUTCHours())+":"+pad(this.getUTCMinutes())+":"+pad(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}})()}function toBase64(e){if(CryptoJS&&CryptoJS.enc.Base64)return CryptoJS.enc.Base64.stringify(CryptoJS.enc.Latin1.parse(e));else return Base64.encode(e)}function toSHA1(e){if(CryptoJS&&CryptoJS.SHA1)return CryptoJS.SHA1(e).toString();else return Crypto.util.bytesToHex(Crypto.SHA1(e,{asBytes:true}))}function toSHA256(e){if(Object.prototype.toString.call(e)!=="[object ArrayBuffer]"){return CryptoJS.SHA256(e).toString(CryptoJS.enc.Hex)}var t=new Uint8Array(e);var i=[];for(var n=0;n<t.length;n+=4){i.push(t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3])}return CryptoJS.SHA256(CryptoJS.lib.WordArray.create(i,t.length)).toString(CryptoJS.enc.Hex)}function isDate(e){if(Object.prototype.toString.call(e)==="[object Date]")var t=e;else var t=new Date(e);if(Object.prototype.toString.call(t)==="[object Date]"){if(isNaN(t.valueOf())){ADL.XAPIWrapper.log("Invalid date String passed");return null}else{return t}}else{ADL.XAPIWrapper.log("Invalid date object");return null}}(function(T){log.debug=false;function getByteLen(e){e=String(e);var t=0;for(var i=0;i<e.length;i++){var n=e.charCodeAt(i);t+=n<1<<7?1:n<1<<11?2:n<1<<16?3:n<1<<21?4:n<1<<26?5:n<1<<31?6:Number.NaN}return t}var e=function(){var e={};e["endpoint"]="http://localhost:8000/xapi/";e["auth"]="Basic "+toBase64("tom:1234");return e}();var t=function(e,t){this.lrs=getLRSObject(e||{});if(this.lrs.user&&this.lrs.password)updateAuth(this.lrs,this.lrs.user,this.lrs.password);this.base=getbase(this.lrs.endpoint);this.withCredentials=false;if(e&&typeof e.withCredentials!="undefined"){this.withCredentials=e.withCredentials}this.strictCallbacks=false;this.strictCallbacks=e&&e.strictCallbacks;function getbase(e){var t=document.createElement("a");t.href=e;if(t.protocol&&t.host){return t.protocol+"//"+t.host}else if(t.href){var i=t.href.split("//");return i[0]+"//"+i[1].substr(0,i[1].indexOf("/"))}else T.XAPIWrapper.log("Couldn't create base url from endpoint: "+e)}function updateAuth(e,t,i){e.auth="Basic "+toBase64(t+":"+i)}if(t&&testConfig.call(this)){window.ADL.XHR_request(this.lrs,this.lrs.endpoint+"about","GET",null,null,function(e){if(e.status==200){try{var t=JSON.parse(e.response);var i=false;for(var n in t.version){if(t.version.hasOwnProperty(n))if(t.version[n]==T.XAPIWrapper.xapiVersion){i=true;break}}if(!i){T.XAPIWrapper.log("The lrs version ["+t.version+"]"+" does not match this wrapper's XAPI version ["+T.XAPIWrapper.xapiVersion+"]")}}catch(e){T.XAPIWrapper.log("The response was not an about object")}}else{T.XAPIWrapper.log("The request to get information about the LRS failed: "+e)}},null,false,null,this.withCredentials,false)}this.searchParams=function(){var e={format:"exact"};return e};this.hash=function(e){if(!e)return null;try{return toSHA1(e)}catch(e){T.XAPIWrapper.log("Error trying to hash -- "+e);return null}};this.changeConfig=function(e){try{T.XAPIWrapper.log("updating lrs object with new configuration");this.lrs=mergeRecursive(this.lrs,e);if(e.user&&e.password)this.updateAuth(this.lrs,e.user,e.password);this.base=getbase(this.lrs.endpoint);this.withCredentials=e.withCredentials;this.strictCallbacks=e.strictCallbacks}catch(e){T.XAPIWrapper.log("error while changing configuration -- "+e)}};this.updateAuth=updateAuth};t.prototype.xapiVersion="1.0.1";t.prototype.prepareStatement=function(e){if(e.actor===undefined){e.actor=JSON.parse(this.lrs.actor)}else if(typeof e.actor==="string"){e.actor=JSON.parse(e.actor)}if(this.lrs.grouping||this.lrs.registration||this.lrs.activity_platform){if(!e.context){e.context={}}}if(this.lrs.grouping){if(!e.context.contextActivities){e.context.contextActivities={}}if(!Array.isArray(e.context.contextActivities.grouping)){e.context.contextActivities.grouping=[{id:this.lrs.grouping}]}else{e.context.contextActivities.grouping.splice(0,0,{id:this.lrs.grouping})}}if(this.lrs.registration){e.context.registration=this.lrs.registration}if(this.lrs.activity_platform){e.context.platform=this.lrs.activity_platform}};t.prototype.testConfig=testConfig;t.prototype.log=log;t.prototype.defaultEncoding="utf-8";t.prototype.sendStatement=function(e,t,i){if(this.testConfig()){this.prepareStatement(e);var n;if(e["id"]){n=e["id"]}else{n=T.ruuid();e["id"]=n}var r=JSON.stringify(e);var o=null;if(i&&i.length>0){o={};r=this.buildMultipartPost(e,i,o)}var s=T.XHR_request(this.lrs,this.lrs.endpoint+"statements","POST",r,this.lrs.auth,t,{id:n},null,o,this.withCredentials,this.strictCallbacks);if(!t)return{xhr:s,id:n}}};t.prototype.stringToArrayBuffer=function(e,t){t=t||T.XAPIWrapper.defaultEncoding;return new TextEncoder(t).encode(e).buffer};t.prototype.stringFromArrayBuffer=function(e,t){t=t||T.XAPIWrapper.defaultEncoding;return new TextDecoder(t).decode(e)};t.prototype.buildMultipartPost=function(e,t,i){e.attachments=[];for(var n=0;n<t.length;n++){if(t[n].type=="signature"){t[n].type={usageType:"http://adlnet.gov/expapi/attachments/signature",display:{"en-US":"A JWT signature"},description:{"en-US":"A signature proving the statement was not modified"},contentType:"application/octet-stream"}}if(typeof t[n].value==="string"){t[n].value=this.stringToArrayBuffer(t[n].value)}t[n].type.length=t[n].value.byteLength;t[n].type.sha2=toSHA256(t[n].value);e.attachments.push(t[n].type)}var r=[];var o=(Math.random()+" ").substring(2,10)+(Math.random()+" ").substring(2,10);i["Content-Type"]="multipart/mixed; boundary="+o;var s="\r\n";var a=["--"+o,"Content-Type: application/json",'Content-Disposition: form-data; name="statement"',"",JSON.stringify(e)].join(s)+s;r.push(a);for(var n in t){if(t.hasOwnProperty(n)){var l=["--"+o,"Content-Type: "+t[n].type.contentType,"Content-Transfer-Encoding: binary","X-Experience-API-Hash: "+t[n].type.sha2].join(s)+s+s;r.push(l);r.push(t[n].value)}}r.push(s+"--"+o+"--"+s);return new Blob(r)};t.prototype.sendStatements=function(e,t){if(this.testConfig()){for(var i in e){if(e.hasOwnProperty(i))this.prepareStatement(e[i])}var n=T.XHR_request(this.lrs,this.lrs.endpoint+"statements","POST",JSON.stringify(e),this.lrs.auth,t,null,false,null,this.withCredentials,this.strictCallbacks);if(!t){return n}}};t.prototype.getStatements=function(e,t,i){if(this.testConfig()){var n=this.lrs.endpoint+"statements";if(t){n=this.base+t}else{var r=new Array;for(s in e){if(e.hasOwnProperty(s)){if(s=="until"||s=="since"){var o=new Date(e[s]);r.push(s+"="+encodeURIComponent(o.toISOString()))}else{r.push(s+"="+encodeURIComponent(e[s]))}}}if(r.length>0)n=n+"?"+r.join("&")}var a=T.XHR_request(this.lrs,n,"GET",null,this.lrs.auth,i,null,false,null,this.withCredentials,this.strictCallbacks);if(a===undefined||a.status==404){return null}try{return JSON.parse(a.response)}catch(e){return a.response}}};t.prototype.getActivities=function(e,t){if(this.testConfig()){var i=this.lrs.endpoint+"activities?activityId=<activityid>";i=i.replace("<activityid>",encodeURIComponent(e));var n=T.XHR_request(this.lrs,i,"GET",null,this.lrs.auth,t,null,true,null,this.withCredentials,this.strictCallbacks);if(n===undefined||n.status==404){return null}try{return JSON.parse(n.response)}catch(e){return n.response}}};t.prototype.sendState=function(e,t,i,n,r,o,s,a){if(this.testConfig()){var l=this.lrs.endpoint+"activities/state?activityId=<activity ID>&agent=<agent>&stateId=<stateid>";l=l.replace("<activity ID>",encodeURIComponent(e));l=l.replace("<agent>",encodeURIComponent(JSON.stringify(t)));l=l.replace("<stateid>",encodeURIComponent(i));if(n){l+="&registration="+encodeURIComponent(n)}var c=null;if(o&&s){log("Can't have both If-Match and If-None-Match")}else if(o){c={"If-Match":T.formatHash(o)}}else if(s){c={"If-None-Match":T.formatHash(s)}}var d="PUT";if(r){if(r instanceof Array){r=JSON.stringify(r);c=c||{};c["Content-Type"]="application/json"}else if(r instanceof Object){r=JSON.stringify(r);c=c||{};c["Content-Type"]="application/json";d="POST"}else{c=c||{};c["Content-Type"]="application/octet-stream"}}else{this.log("No activity state was included.");return false}T.XHR_request(this.lrs,l,d,r,this.lrs.auth,a,null,null,c,this.withCredentials,this.strictCallbacks)}};t.prototype.getState=function(e,t,i,n,r,o){if(this.testConfig()){var s=this.lrs.endpoint+"activities/state?activityId=<activity ID>&agent=<agent>";s=s.replace("<activity ID>",encodeURIComponent(e));s=s.replace("<agent>",encodeURIComponent(JSON.stringify(t)));if(i){s+="&stateId="+encodeURIComponent(i)}if(n){s+="&registration="+encodeURIComponent(n)}if(r){r=isDate(r);if(r!=null){s+="&since="+encodeURIComponent(r.toISOString())}}var a=T.XHR_request(this.lrs,s,"GET",null,this.lrs.auth,o,null,true,null,this.withCredentials,this.strictCallbacks);if(a===undefined||a.status==404){return null}try{return JSON.parse(a.response)}catch(e){return a.response}}};t.prototype.deleteState=function(e,t,i,n,r,o,s){if(this.testConfig()){var a=this.lrs.endpoint+"activities/state?activityId=<activity ID>&agent=<agent>&stateId=<stateid>";a=a.replace("<activity ID>",encodeURIComponent(e));a=a.replace("<agent>",encodeURIComponent(JSON.stringify(t)));a=a.replace("<stateid>",encodeURIComponent(i));if(n){a+="&registration="+encodeURIComponent(n)}var l=null;if(r&&o){log("Can't have both If-Match and If-None-Match")}else if(r){l={"If-Match":T.formatHash(r)}}else if(o){l={"If-None-Match":T.formatHash(o)}}var c=T.XHR_request(this.lrs,a,"DELETE",null,this.lrs.auth,s,null,false,l,this.withCredentials,this.strictCallbacks);if(c===undefined||c.status==404){return null}try{return JSON.parse(c.response)}catch(e){return c}}};t.prototype.sendActivityProfile=function(e,t,i,n,r,o){if(this.testConfig()){var s=this.lrs.endpoint+"activities/profile?activityId=<activity ID>&profileId=<profileid>";s=s.replace("<activity ID>",encodeURIComponent(e));s=s.replace("<profileid>",encodeURIComponent(t));var a=null;if(n&&r){log("Can't have both If-Match and If-None-Match")}else if(n){a={"If-Match":T.formatHash(n)}}else if(r){a={"If-None-Match":T.formatHash(r)}}var l="PUT";if(i){if(i instanceof Array){i=JSON.stringify(i);a=a||{};a["Content-Type"]="application/json"}else if(i instanceof Object){i=JSON.stringify(i);a=a||{};a["Content-Type"]="application/json";l="POST"}else{a=a||{};a["Content-Type"]="application/octet-stream"}}else{this.log("No activity profile was included.");return false}T.XHR_request(this.lrs,s,l,i,this.lrs.auth,o,null,false,a,this.withCredentials,this.strictCallbacks)}};t.prototype.getActivityProfile=function(e,t,i,n){if(this.testConfig()){var r=this.lrs.endpoint+"activities/profile?activityId=<activity ID>";r=r.replace("<activity ID>",encodeURIComponent(e));if(t){r+="&profileId="+encodeURIComponent(t)}if(i){i=isDate(i);if(i!=null){r+="&since="+encodeURIComponent(i.toISOString())}}var o=T.XHR_request(this.lrs,r,"GET",null,this.lrs.auth,n,null,true,null,this.withCredentials,this.strictCallbacks);if(o===undefined||o.status==404){return null}try{return JSON.parse(o.response)}catch(e){return o.response}}};t.prototype.deleteActivityProfile=function(e,t,i,n,r){if(this.testConfig()){var o=this.lrs.endpoint+"activities/profile?activityId=<activity ID>&profileId=<profileid>";o=o.replace("<activity ID>",encodeURIComponent(e));o=o.replace("<profileid>",encodeURIComponent(t));var s=null;if(i&&n){log("Can't have both If-Match and If-None-Match")}else if(i){s={"If-Match":T.formatHash(i)}}else if(n){s={"If-None-Match":T.formatHash(n)}}var a=T.XHR_request(this.lrs,o,"DELETE",null,this.lrs.auth,r,null,false,s,this.withCredentials,this.strictCallbacks);if(a===undefined||a.status==404){return null}try{return JSON.parse(a.response)}catch(e){return a}}};t.prototype.getAgents=function(e,t){if(this.testConfig()){var i=this.lrs.endpoint+"agents?agent=<agent>";i=i.replace("<agent>",encodeURIComponent(JSON.stringify(e)));var n=T.XHR_request(this.lrs,i,"GET",null,this.lrs.auth,t,null,true,null,this.withCredentials,this.strictCallbacks);if(n===undefined||n.status==404){return null}try{return JSON.parse(n.response)}catch(e){return n.response}}};t.prototype.sendAgentProfile=function(e,t,i,n,r,o){if(this.testConfig()){var s=this.lrs.endpoint+"agents/profile?agent=<agent>&profileId=<profileid>";s=s.replace("<agent>",encodeURIComponent(JSON.stringify(e)));s=s.replace("<profileid>",encodeURIComponent(t));var a=null;if(n&&r){log("Can't have both If-Match and If-None-Match")}else if(n){a={"If-Match":T.formatHash(n)}}else if(r){a={"If-None-Match":T.formatHash(r)}}var l="PUT";if(i){if(i instanceof Array){i=JSON.stringify(i);a=a||{};a["Content-Type"]="application/json"}else if(i instanceof Object){i=JSON.stringify(i);a=a||{};a["Content-Type"]="application/json";l="POST"}else{a=a||{};a["Content-Type"]="application/octet-stream"}}else{this.log("No agent profile was included.");return false}T.XHR_request(this.lrs,s,l,i,this.lrs.auth,o,null,false,a,this.withCredentials,this.strictCallbacks)}};t.prototype.getAgentProfile=function(e,t,i,n){if(this.testConfig()){var r=this.lrs.endpoint+"agents/profile?agent=<agent>";r=r.replace("<agent>",encodeURIComponent(JSON.stringify(e)));r=r.replace("<profileid>",encodeURIComponent(t));if(t){r+="&profileId="+encodeURIComponent(t)}if(i){i=isDate(i);if(i!=null){r+="&since="+encodeURIComponent(i.toISOString())}}var o=T.XHR_request(this.lrs,r,"GET",null,this.lrs.auth,n,null,true,null,this.withCredentials,this.strictCallbacks);if(o===undefined||o.status==404){return null}try{return JSON.parse(o.response)}catch(e){return o.response}}};t.prototype.deleteAgentProfile=function(e,t,i,n,r){if(this.testConfig()){var o=this.lrs.endpoint+"agents/profile?agent=<agent>&profileId=<profileid>";o=o.replace("<agent>",encodeURIComponent(JSON.stringify(e)));o=o.replace("<profileid>",encodeURIComponent(t));var s=null;if(i&&n){log("Can't have both If-Match and If-None-Match")}else if(i){s={"If-Match":T.formatHash(i)}}else if(n){s={"If-None-Match":T.formatHash(n)}}var a=T.XHR_request(this.lrs,o,"DELETE",null,this.lrs.auth,r,null,false,s,this.withCredentials,this.strictCallbacks);if(a===undefined||a.status==404){return null}try{return JSON.parse(a.response)}catch(e){return a}}};function testConfig(){try{return this.lrs.endpoint!=undefined&&this.lrs.endpoint!=""}catch(e){return false}}function log(e){if(!log.debug)return false;try{console.log(e);return true}catch(e){return false}}function mergeRecursive(t,i){for(var n in i){if(i.hasOwnProperty(n)==false)continue;var e=i[n];log(n+" : "+e);try{if(i[n].constructor==Object){t[n]=mergeRecursive(t[n],i[n])}else{if(t==undefined){t=new Object}t[n]=i[n]}}catch(e){if(t==undefined){t=new Object}t[n]=i[n]}}return t}function getLRSObject(e){var t=["endpoint","auth","actor","registration","activity_id","grouping","activity_platform"];var i=new Object;var n,r;n=parseQueryString();if(n!==undefined&&Object.keys(n).length!==0){for(var o=0;o<t.length;o++){r=t[o];if(n[r]){i[r]=n[r];delete n[r]}}i=mergeRecursive(e,i)}else{i=e}return i}function parseQueryString(){var e,t,i,n,r;e=window.location.search.substr(1);t=e.split("&");r={};for(n=0;n<t.length;n++){i=t[n].split("=");if(i.length===2&&i[0]){r[i[0]]=decodeURIComponent(i[1])}}return r}function delay(){var e=new XMLHttpRequest;var t=window.location+"?forcenocache="+T.ruuid();e.open("GET",t,false);e.send(null)}function ie_request(e,t,i,n){var r=t;var o=new Array;var s=r.indexOf("?");if(s>0){o.push(r.substr(s+1));r=r.substr(0,s)}r=r+"?method="+e;if(i!==null){for(var a in i){if(i.hasOwnProperty(a))o.push(a+"="+encodeURIComponent(i[a]))}}if(n!==null){o.push("content="+encodeURIComponent(n))}return{method:"POST",url:r,headers:{},data:o.join("&")}}T.ruuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,i=e=="x"?t:t&3|8;return i.toString(16)})};T.dateFromISOString=function(e){var t="([0-9]{4})(-([0-9]{2})(-([0-9]{2})"+"([T| ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?"+"(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?";var i=e.match(new RegExp(t));var n=0;var r=new Date(i[1],0,1);if(i[3]){r.setMonth(i[3]-1)}if(i[5]){r.setDate(i[5])}if(i[7]){r.setHours(i[7])}if(i[8]){r.setMinutes(i[8])}if(i[10]){r.setSeconds(i[10])}if(i[12]){r.setMilliseconds(Number("0."+i[12])*1e3)}if(i[14]){n=Number(i[16])*60+Number(i[17]);n*=i[15]=="-"?1:-1}n-=r.getTimezoneOffset();time=Number(r)+n*60*1e3;var o=new Date;o.setTime(Number(time));return o};T.XHR_request=function(e,n,r,t,i,o,s,a,l,c,d){"use strict";var u,f=false,p=false,h=false,g,m=n.toLowerCase().match(/^(.+):\/\/([^:\/]*):?(\d+)?(\/.*)?$/),v=window.location,y,S,b,x,C;var w={};w["Content-Type"]="application/json";w["Authorization"]=i;w["X-Experience-API-Version"]=T.XAPIWrapper.xapiVersion;if(l!==null){for(var A in l){if(l.hasOwnProperty(A))w[A]=l[A]}}p=v.protocol.toLowerCase()!==m[1]||v.hostname.toLowerCase()!==m[2];if(!p){y=m[3]===null?m[1]==="http"?"80":"443":m[3];p=y===v.port}if(e!==null&&e.extended!==undefined){b=new Array;for(x in e.extended){b.push(x+"="+encodeURIComponent(e.extended[x]))}if(b.length>0){n+=(n.indexOf("?")>-1?"&":"?")+b.join("&")}}var I=window.XDomainRequest&&(window.XMLHttpRequest&&(new XMLHttpRequest).responseType===undefined);if(!p||I===undefined||I===false){u=new XMLHttpRequest;u.withCredentials=c;u.open(r,n,o!=null);for(var A in w){u.setRequestHeader(A,w[A])}}else{h=true;g=ie_request(r,n,w,t);u=new XDomainRequest;u.open(g.method,g.url)}function requestComplete(){if(!f){f=true;var e=a&&u.status===404;if(u.status===undefined||u.status>=200&&u.status<400||e){if(o){if(s){d?o(null,u,s):o(u,s)}else{var t;try{t=JSON.parse(u.responseText)}catch(e){t=u.responseText}d?o(null,u,t):o(u,t)}}else{S=u;return u}}else{var i;try{i="There was a problem communicating with the Learning Record Store. ( "+u.status+" | "+u.response+" )"+n}catch(e){i=e.toString()}T.XAPIWrapper.log(i);T.xhrRequestOnError(u,r,n,o,s,d);S=u;return u}}else{return S}}u.onreadystatechange=function(){if(u.readyState===4){return requestComplete()}};u.onload=requestComplete;u.onerror=requestComplete;u.send(h?g.data:t);if(!o){if(h){C=1e3+new Date;while(new Date<C&&u.readyState!==4&&!f){delay()}}return requestComplete()}};T.xhrRequestOnError=function(t,e,i,n,r,o){if(n&&o){var s=t?t.status:undefined;var a;if(s){a=new Error("Request error: "+t.status)}else if(s===0||s===null){a=new Error("Request error: aborted")}else{a=new Error("Reqeust error: unknown")}if(r){n(a,t,r)}else{var l;try{l=JSON.parse(t.responseText)}catch(e){l=t.responseText}n(a,t,l)}}};T.formatHash=function(e){return e==="*"?e:'"'+e+'"'};T.XAPIWrapper=new t(e,false)})(window.ADL=window.ADL||{});